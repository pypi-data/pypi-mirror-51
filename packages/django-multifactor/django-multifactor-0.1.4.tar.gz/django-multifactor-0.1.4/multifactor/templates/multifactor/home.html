{% extends "multifactor/base.html" %}
{% load static %}

{% block card_title %}Multifactor Authentication{% endblock %}
{% block card_classes %}{% endblock %}

{% block content %}
{% if authed %}
<div class="btn-group mb-4 ml-4 float-right">
	<button class="btn btn-success dropdown-toggle" data-toggle="dropdown">
		Add Method&nbsp;<span class="caret"></span>
	</button>
	<div class="dropdown-menu dropdown-menu-right">
		{% for link, label in available_methods %}
		<a class="dropdown-item" href="{% url link %}">{{label}}</a>
		{% endfor %}
	</div>
</div>
{% endif %}

<p>To keep your account secure, you can add one or more secondary authentication factors. These are commonly USB keys, or codes acquired through a secure mechanism like an authenticator. </p>

<table class="table table-striped mb-0">
	<thead>
		<tr>
			<th>Type</th>
			<th>Added</th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		{% for key in keys %}
		<tr>
			<td class="align-middle">
				<strong>{{ key.get_key_type_display }}</strong>
			</td>
			<td class="align-middle">
				Added: {{ key.added_on }}<br>
				Expires: {{ key.expires|default:"Never" }}<br>
				Last used: {{ key.last_used|default:"Never" }}
			</td>
			<td class="align-middle text-right" style="width:10%;white-space: nowrap;">
				{% if authed %}
				<a href="{% url 'multifactor:toggle_key' key.pk %}" class="btn btn-{{key.enabled|yesno:'success,warning'}}">{{key.enabled|yesno:'Enabled,Disabled'}}</a>
				<a class="btn btn-danger delete" href="{% url 'multifactor:delete_key' key.pk %}" onclick="return confirm('Are you sure you want to delete this key?')">Delete</a>
				{% endif %}
			</td>
		</tr>
		{% empty %}
		<tr>
			<td colspan="3" align="center">You don't have any keys yet, please add one.</td>
		</tr>
		{% endfor %}
	</tbody>
</table>
{% endblock %}


{% block head %}{% endblock %}