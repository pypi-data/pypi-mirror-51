{% extends "multifactor/base.html" %}{% load static %}

{% block card_title %}Add Authenticator{% endblock %}
{% block card_classes %}card-login mx-auto{% endblock %}

{% block content %}
<p>Start by downloading an Authenticator App on your phone. <a href="#suggestions" data-toggle="collapse">Show suggestions...</a></p>
<ul class="collapse" id="suggestions">
	<li>Android <a href='https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2' target='_blank'>Google Authenticator</a></li>
	<li>iPhone/iPad <a href='https://itunes.apple.com/us/app/authy/id494168017' target='_blank'>Authy</a></li>
	<li>Chrome <a href='https://chrome.google.com/webstore/detail/authenticator/bhghoamapcdpbohphigoooaddinpkbai?hl=en'>Google Authenticator</a>
</ul>

<div class="text-center">
	<img id="qr" />
	<p><code>{{secret_key}}</code></p>
</div>

<p>Use your Authenticator to scan in this QR Code. It should give you a six-digit code in return. Enter this code below and click Verify.</p>

<form action="" method="POST">
	{% csrf_token %}
	<input type="hidden" name="key" value="{{secret_key|safe}}">
	<div class="form-group">
		<div class="input-group">
			<input maxlength="6" size="6" class="form-control" name="answer" placeholder="e.g 123456" autocomplete="off" autofocus/>
		</div>
	</div>

	<button type="submit" class="btn btn-lg btn-success btn-block">Verify</button>
	<a class="btn btn-block" href="{% url 'multifactor:home' %}">Cancel</a>
</form>
{% endblock %}

{% block head %}
<script src="{% static 'multifactor/js/qrious.min.js' %}" type="text/javascript"></script>
<script type="text/javascript">
var key="{{secret_key|safe}}";

var qr = new QRious({
	element: document.getElementById('qr'),
	value: "{{qr|safe}}",
	size: 250,
});

</script>
{% endblock %}
