{% extends "multifactor/base.html" %}
{% load static %}

{% block card_title %}Multi-Factor Authentication Dashboard{% endblock %}
{% block card_classes %}{% endblock %}

{% block content %}
{% if can_edit %}
<div class="btn-group mb-4 ml-4 float-right">
	<button class="btn btn-success dropdown-toggle" data-toggle="dropdown">
		Add Method&nbsp;<span class="caret"></span>
	</button>
	<div class="dropdown-menu dropdown-menu-right">
		{% for link, label in available_methods %}
		<a class="dropdown-item" href="{% url link %}">{{label}}</a>
		{% endfor %}
	</div>
</div>
{% endif %}

<p>To keep your account secure, you can add one or more secondary authentication factors. These are commonly USB keys, or codes acquired through a secure mechanism like an authenticator. </p>

<table class="table table-striped">
	<thead>
		<tr>
			<th>Type</th>
			<th>Added</th>
			<th></th>
		</tr>
	</thead>
	<tbody>
		{% for key in keys %}
		<tr>
			<td class="align-middle">
				<strong>{{ key.get_key_type_display }}</strong>
			</td>
			<td class="align-middle">
				Added: {{ key.added_on }}<br>
				Expires: {{ key.expires|default:"Never" }}<br>
				Last used: {{ key.last_used|default:"Never" }}
			</td>
			<td class="align-middle text-right" style="width:10%;white-space: nowrap;">
				{% if can_edit %}
				<a href="{% url 'multifactor:toggle_key' key.pk %}" class="btn btn-{{key.enabled|yesno:'success,warning'}}">{{key.enabled|yesno:'Enabled,Disabled'}}</a>
				<a class="btn btn-danger delete" href="{% url 'multifactor:delete_key' key.pk %}" onclick="return confirm('Are you sure you want to delete this key?')">Delete</a>
				{% endif %}
			</td>
		</tr>
		{% empty %}
		<tr>
			<td colspan="3" align="center">You don't have any keys yet, please add one.</td>
		</tr>
		{% endfor %}
	</tbody>
</table>

<a href="#explanation" class="btn btn-light btn-block btn-sm" data-toggle="collapse">But what <em>is</em> multi-factor authentication? Where do I start?</a>

</div>
<div class="card-footer collapse" id="explanation">
	<h4>What is multi-factor authentication?</h4>

	<p>Traditionally you have logged in with a username and password,
	maybe directly, maybe through a single sign-in portal. It's a tried
	and tested authentication system <strong>but it has one key flaw...</strong> 
	Anybody can pretend to be you, if they have your credentials.</p>

	<p>Usernames, passwords, even "secret questions" are all *something you know*. 
	This is a particularly weak factor as many people reuse or share passwords,
	and recovery information like mothers' maiden names a reoften public record.</p>

	<p>Multi-factor authentication adds different <strong>types</strong> of factor:</p>
	<ul>
		<li><em>Something you have</em>, like a USB security token</li>
		<li><em>Something you are</em>, like a fingerprint or voice scan</li>
	</ul>

	<p>Adding another factor makes it much harder for somebody to break into your account. It protects your
	account and the data your account has access to.</p>

	<h4>Where to start? What factor should I add?</h4>

	<p>An App-based TOTP Authenticator is the cheapest, most secure way to get started.
	Download an Authenticator (eg Google Authenticator or Authy) on your phone.
	Click the Add button above, and select TOTP Authenticator.
	Scan in the barcode in your Authenticator app and then copy back the 6-digit code.</p>

	<p>That's it. In the future you will be asked for the current code the Authenticator
	displays. Just copy, submit and carry on with your day.</p>

	<p>If your computer has a Windows Hello-powered fingerprint reader, or facial
	recognition, you can use these as a FIDO2 Security Device. You can also
	purchase FIDO2 USB keys, or U2F USB buttons that you only need press to authenticate.</p>

</div>
{% endblock %}


{% block head %}{% endblock %}