import pytest
import numpy as np
from scipy.spatial.distance import jaccard
from rdkit.Chem import AllChem
from mhfp.encoder import MHFPEncoder

# Keeping tests barebone and simple

mhfp_encoder = MHFPEncoder()
smiles = 'CCCC1=NN(C2=C1NC(=NC2=O)C3=C(C=CC(=C3)S(=O)(=O)N4CCN(CC4)C)OCC)C'
mol = AllChem.MolFromSmiles(smiles)
shingling = sorted([b'c1cnnc1', b'Cn(nc)c(c)c', b'C(C)Oc', b'c1(OCC)ccccc1-c([nH])n', b'S(c)(N)(=O)=O', b'c(nc)([nH]c)-c(c)c', b'CN(C)C', b'n(c(-c)[nH])c(c)=O', b'C(C)O', b'N(C)(C)S', b'S(=O)(=O)(c(cc)cc)N(CC)CC', b'CC', b'c1(CCC)nn(C)c(c)c1[nH]c', b'c1(S(=O)(=O)N(C)C)cccc(-c)c1', b'N(C)(C)C', b'c(cc)c(c)S', b'N1(S(=O)(=O)c(c)c)CCNCC1', b'c(c)(c)[nH]', b'O=c(nc)c(c)n', b'N(C)(CC)CC', b'n(c(c)C)n(c)C', b'C1CNCCN1', b'c1ccccc1', b'C(C)N', b'n(c)(C)n', b'C(CC)c(c)n', b'c(c(c)-c)c(c)S', b'O(c)C', b'CCO', b'CN(CC)CC', b'[nH](c)c', b'n(c)c', b'n1c(-c(c)c)[nH]cc(n)c1=O', b'N(CC)(CC)S(c)(=O)=O', b'C(CN)N(C)C', b'S(=O)(=O)(c(c)c)N(C)C', b'O(CC)c(cc)c(c)-c', b'C(C)Oc(c)c', b'C(C)Cc', b'C(CN)N(C)S', b'c1(-c(nc)[nH]c)cc(S)ccc1OC', b'c(cc)(OC)c(c)-c', b'n1c(CC)c([nH])c(c)n1C', b'c(c)(c)-c', b'c([nH]c)(c(C)n)c(c)n', b'c(c)(c)O', b'c1cc(O)ccc1S(N)(=O)=O', b'O=S(c)(N)=O', b'c12[nH]c(-c)nc(=O)c1n(C)nc2CC', b'c(-c)([nH])n', b'c1(=O)nc(-c)[nH]c(c)c1n(C)n', b'c1cc(S)cc(-c)c1OC', b'O(CC)c(c)c', b'c(c)(c)n', b'C(C)C', b'n(c)n', b'CCOc', b'c(cc)(-c([nH])n)c(c)O', b'c(CC)(nn)c(c)[nH]', b'c(c)(c)S', b'CCC', b'N1(C)CCNCC1', b'c(c(n)=O)(c(c)[nH])n(C)n', b'n(C)(nc)c(c)c', b'c(c)(n)=O', b'Cn(c)n', b'c(cc)(cc)S(N)(=O)=O', b'O=c(c)n', b'c(c)c', b'n1(C)nc(C)c([nH])c1c(n)=O', b'c1c(S(N)(=O)=O)ccc(O)c1-c([nH])n', b'C(C)Cc(c)n', b'C(C)c', b'c(=O)(nc)c(c)n',b'[nH](c(-c)n)c(c)c', b'C(CC)c(nn)c(c)[nH]', b'O=c', b'c1(-c(cc)c(c)O)nc(=O)cc(c)[nH]1', b'c(cc)c(c)O', b'c(c)(C)n', b'O=S', b'c1cnc[nH]c1', b'O=S(=O)(c(c)c)N(C)C', b'C1CN(C)CCN1S(c)(=O)=O', b'c12c(=O)nc[nH]c1c(C)nn2C', b'C1CN(S)CCN1C', b'[nH]1c(-c(c)c)ncc(n)c1c(C)n', b'Cn', b'CCCc', b'CN'])
fp = [15876248,33988699,14316170,98479663,26498900,44875297,22578275,4776908,4563631,34642650,3838604,96645149,39424161,12666245,13601147,112475652,214331237,39365392,19701192,10486947,43545081,49556783,97443927,2092446,56647235,14889296,44490976,24495618,12133432,82116750,118668153,15032974,9391986,51308236,32152717,20754971,70110939,17219712,18724779,30993118,40959932,48460770,51216250,24903206,41225061,13955243,29414301,179475019,7761413,11037072,17475197,76265973,30440391,105308263,57554678,78090606,63863453,27672927,40103953,54772740,10638988,9139402,71870537,5264490,128686919,9713288,25475549,30598321,35918699,263026375,59356160,141997935,23309910,94335775,49418911,18775240,34221575,44951847,19057716,46002294,66981608,3732523,8527046,5728614,7706280,154942644,54099913,25852557,88154148,17328911,45949835,21300722,56402749,98703302,22056165,17404580,69073815,80203816,20373129,111667703,76476038,18431483,89705184,12661123,29234220,35895089,112428213,22992214,1075640,86406022,59230757,5908947,18035843,79830729,12428092,30644205,14363875,127442851,35111287,1477975,28648584,17072148,66503970,692167,64736311,15541780,5831656,54656873,27287292,17448242,13171605,1929107,83191474,99177791,20091687,23997455,19611447,3097891,107577112,10783241,20821959,34612550,12714006,63534125,75786128,25490500,1250479,25569165,3222232,111440958,102985837,49019108,14422354,30921089,108546789,22693558,2839938,48643847,24124215,18654268,45606372,58212685,21250869,60489107,594719,19052487,30198018,27137697,155001109,67445247,59271133,64236476,122300960,19565046,123268294,82433728,67202706,16427814,24985835,88034881,995272,14255925,23574879,15564155,77009472,74584715,7392971,14211242,123364656,27854612,26654445,131894636,24196156,203861120,5469897,14342722,47698895,59708590,65674021,53638856,5452491,18342270,29761875,39474777,77511657,7676446,21145144,9800726,30236996,46336237,126681981,66152576,49318220,36937662,3769195,69917313,63818445,19390879,14134919,13865293,19926976,74176444,19753574,15315229,169200720,93718177,76563511,45381378,74592929,11073832,12759046,145223866,68378886,2741920,104368481,40250235,33379362,65014310,27069814,22894738,50373097,35245716,14649483,2429353,65455,35026484,7522466,4948235,13895251,7507985,34266637,41928471,68946854,2090050,4809873,9243581,85419998,65272916,68475909,22560689,25611118,5044806,28129786,637548,95680725,18221143,57061500,49931828,9620790,91676222,35402847,1031941,44002933,56730155,26216354,159066522,248126874,73994192,48041965,9548445,36882270,15635350,34717493,9541347,156432,101144372,21731428,2167727,2731415,40234453,47593678,35948813,106573072,10752978,94307344,93676980,12453717,40880243,6413428,13807673,5667045,14764481,1419922,46397308,58151019,95871041,16702773,56477014,38643841,9210838,5660929,106850819,116106858,21051722,28233991,57358241,3362834,7058275,53044522,66154883,17590753,84545928,4447796,25913182,10503644,80718341,54909478,165042506,35452594,9269285,5413218,22943010,16741655,76827473,1685156,42464269,32240567,159292248,102691719,97691809,12212244,18408944,8945179,25386046,20890788,35314895,771955,51367213,54633776,9947606,50848563,93370150,12889465,18780075,27197135,2285083,16526187,4900127,66479727,12654131,5252728,54434112,59977058,7065717,75795914,67370293,13273589,96019752,57843220,1363151,7657023,13740798,105438269,51756268,15488214,24065092,172096059,43710147,208312992,68362350,11146201,47267886,71991726,33091065,21251552,37164210,10525464,22049274,49776389,5494498,18055627,2030499,49543052,226741700,101058478,27930173,14077242,15063321,160961889,72950623,31268892,17033421,72594597,54953432,103768236,13114618,21633347,84285620,82182044,76572548,158943691,30942868,62731315,63277444,11741692,48388748,11297444,75727489,60082248,37410264,61461113,101473253,14986507,13148351,9404826,21874230,61491286,19470583,32413172,1087304,44889772,18050121,4553908,8460501,43743272,91461728,100038356,48633042,1811469,37066596,43372037,41517471,31402396,86930492,96684248,4029652,12081923,13329507,45955367,35203996,7338767,204548790,60633107,244963514,61555247,9710460,21390943,123166913,27976735,9340227,75821270,25886581,35206339,1617302,7411486,12964328,24253548,83185840,63227240,28525543,54378344,28430700,55273456,13811114,4110056,52051811,180460628,115748724,34941088,33953186,28909515,69457938,79047993,16171014,31655852,44426790,9047019,71505201,120940527,211509037,152573299,60961844,40010977,18755591,80342473,17701773,31313409,33891924,104390329,46805786,41944734,34328485,127235646,106027616,10386743,169676893,22501024,26294092,1654850,51155140,7123696,25178277,108782101,83363428,45522927,91585507,3884265,1472898,1135310,43297815,38676598,28402122,21157784,981546,39636742,182562724,9971573,6939101,23014918,126603411,45732116,60865223,6726380,52197720,34243046,58276825,6977100,109056273,4541322,16766370,90791457,29722824,9564906,58754455,194442625,54470090,41601230,253649907,74145085,15815822,36685595,2576892,24981889,23335646,45898024,28769585,26019678,25612816,2419968,10735795,62659482,2204845,2555119,72059561,33478885,31343065,143158472,8098233,20051469,88058916,127739504,3223750,105342785,11906899,77280892,42568676,167137017,52372936,21158104,139758703,36140980,59461783,225048921,11212591,20459610,100620522,9457900,21218727,30074382,27535716,28151953,96295499,280586643,17311656,76741192,71593610,13491944,74216434,14646078,81803844,3258672,45659849,4818851,99540621,17220455,128287433,47494861,22980460,10217449,46564574,181349069,3806823,90305620,85834979,6150000,15863287,105991648,135267729,6874773,36778923,2452862,5769983,55041268,35728211,11532389,5129218,39076593,62676605,14036352,101705170,72843293,24494083,65977418,17799021,26110581,5943209,4653343,83341073,6556250,34348200,10944594,7365433,32698682,136476167,78977628,93463771,37212556,1107657,19462345,28119784,42298912,22300189,24579260,17475815,103142164,33240857,21135966,29715781,48960249,48727208,15604090,15533990,128293786,4425426,4748418,25909883,29153598,2952701,2089675,46476407,81173102,41089687,128593543,21642058,55353548,177134811,5062284,15473901,44436142,15178258,34277287,75179030,37174173,182799,100232133,28417703,941769,376933,31095024,21920351,5883087,156212081,22132998,27457269,39414391,19030559,20951333,56180611,48544646,38788048,32774000,49040909,38781441,42306986,61193563,72537053,174662622,411513,59510092,100009968,108320150,106179498,96194301,74412708,24134458,102040224,10098533,62646233,171911102,48985010,79740314,5318534,19117225,22297863,3205935,157247708,9906298,49553016,19293945,24570626,91598259,20243048,25031049,39708107,10518440,84424991,85673267,19148863,85653576,154197677,668979,68785788,94876477,45565209,13018878,6235231,40455126,128705944,77609535,1970542,94173195,36421872,43075902,679673,77204851,85554436,41544226,15398049,68645971,5272164,28896094,49618415,195456965,87884870,65970901,48992247,15656258,6362566,10877798,14173924,11859003,52575500,18979771,15173150,144459861,1254252,137223051,100977172,28807606,18510377,94591402,24886661,32764900,21396248,67006028,87858913,66699339,282558134,40934805,77570182,365749885,27149362,6291451,31743637,31614564,5458606,34161855,154427139,52553788,14512060,10153862,74968502,265399274,11027348,57935800,53711752,19651776,61879126,18501173,71469058,49889692,26685977,11842932,16133488,12408164,15337527,63085502,47995011,20471067,192798027,15593036,16457733,3204816,2968262,70733998,95415260,36436652,74860482,6701738,70933997,18117423,63887586,75123091,37879648,23985716,3199344,7865176,12833061,11395937,14045495,17663105,18233216,49623003,12852144,90681852,54165547,5376634,64030987,80939811,40735695,86595958,33681511,103479530,49073286,3002557,40602091,18887157,23017757,20476682,95146634,67125456,71954663,8751399,13720680,33357463,54042280,15672574,18586592,9176254,104050850,116881001,82402280,170961433,127337240,291175,66444659,3393046,34962876,14373521,12366609,73262502,6734969,116621766,136978576,12164518,34101739,9647621,39933642,88882892,59670903,15779875,8474677,36975718,11317671,8051404,17551934,6971918,35779521,65840453,14370364,1534068,46837697,18034568,4332812,17972821,40437094,45204798,18402182,18616024,67636220,176390140,44314495,79290363,138464173,10735056,60283732,5219430,952393,30146223,213509536,29233925,49243530,50143892,64657375,18948964,60156288,1169554,3479657,11114371,30536826,52877041,33552969,79367653,143221746,5632503,16321514,38152596,83463941,39355719,17619864,10041521,30654141,598451,1133879,16852377,25607777,12133730,93180422,24258384,49993673,31908756,29842532,3328084,10238744,26777674,22479101,32903089,10012097,21607005,1992243,36397805,97369962,104026154,11828478,43760306,17590435,149027126,15252115,41754912,52364146,19981267,138386859,127512,63931730,58866406,29284558,8493219,12165722,104192682,105259854,80974434,15336919,17471769,7840857,28868366,40418887,50700959,47248832,138489313,4590315,69390863,499482,74965669,88662275,61651263,9751230,34034175,80467253,13612356,20499477,17898253,19897703,66583962,27931470,133101949,24739234,5468725,7113003,22257094,74485877,38217192,238688196,32051709,6963404,71928479,75688469,40736515,55414313,16767892,28038956,33612969,26774052,108269303,4689592,14230145,89549524,43064351,46596931,96562756,11000434,16211287,50485192,39243867,85395564,38918354,32102306,6226385,52811389,106566378,800770,71373499,44083653,122118427,34024094,75314924,24169679,22963877,28345608,37732933,29295912,27187307,1574209,69927679,51104797,88968240,22465968,5950826,44153961,6214737,138246733,2333619,36714802,88605631,24212954,47260195,30579206,13125646,23171998,5673703,23153339,12033077,166802052,65709092,6867395,88846456,39219188,85425928,94824451,5918970,1124164,5966103,127210954,7696860,58776342,14367963,16697752,3517517,131483559,54119895,51867110,66961752,22495916,24120790,78000590,6939300,51873376,2743130,45237654,25173912,65217622,40334301,12864958,37205092,69675275,23775132,18866852,7862632,41504625,34617888,47973658,28407330,75962626,16977068,13087240,34202804,98577526,13620720,64053458,583937,6331288,33227938,116998441,58858913,3833787,24368808,166553537,16442262,95592019,24349900,32761466,14389519,97357211,76586346,159698219,48583510,14154333,34787962,44914252,31742013,39529961,38364638,163534383,29834489,23139201,25366028,93349477,11118125,17851059,71596387,11235884,18326554,45134817,19549193,21107399,85477525,22042719,81187373,27591391,23582226,248746220,38898004,36209191,46532025,90961024,299361,35391137,23293470,10501908,35361763,10799308,47862140,35768440,10352270,3744900,374171,46202196,133795233,11784682,20144054,91801414,39056449,7809771,118793770,33585136,75437738,24168367,8060739,667713,35640365,92432568,22452588,19250047,73549492,66932137,2465854,20807159,142545070,29948371,62749746,49799610,15935540,24471409,22885130,161228092,29269970,22537735,44220322,67378917,6786405,72140138,16219787,72424312,22854893,7949432,36793370,1396119,18010364,36486001,42472744,45335308,62425024,22440231,14241560,88320813,11877796,6669699,39333036,47187209,43342157,680476,92778377,46028292,48459437,20119280,105273294,55537393,89736865,30305866,30821779,22933904,84643423,36968551,26157164,40002965,9719330,78891098,78217963,27168060,11842461,44576762,90575532,9702536,1764940,32316507,16663099,156561808,30538793,40288268,12658316,128920642,19927559,96165055,11734334,106397847,114771588,55898759,186946833,92017816,21500139,169411690,21379516,267450413,73029340,68767866,41524340,110841232,45262900,3602319,74273710,107211733,169481343,5655148,22284165,36376209,131038888,29338650,11451190,55981983,33487770,10559137,73114134,46843213,61925667,65217943,2350942,67354871,32324008,33181988,91144759,51931521,520700,134703968,12010623,64357640,46925111,76380295,65686927,38524531,1206364,30639418,1004998,50715775,41695417,24549303,182101894,76002126,15682943,19169671,41891497,92179007,53071989,21074147,6142832,59793284,39116893,72235388,3506644,13926756,333040,6209237,40989313,25547878,32093680,265111,101655150,357253187,33841724,66225136,58348124,123805415,34454228,24735004,56227802,78677861,52773927,119478224,25632795,227925281,40605723,14853193,19618650,36914888,62643897,74856951,39679203,59131930,18209833,53920278,36580486,127639910,51722698,16957394,31690218,7959420,13984778,69130788,130179283,4332685,6468825,133225717,12552781,68644995,30648121,90498594,44212827,15743928,29238947,9940214,33751410,109994478,40103878,12874663,5966575,117762954,56422894,10953112,12644443,12391211,4099709,200011450,24967699,13443390,5452333,55143272,50679395,8022466,141546967,84224875,19673006,23212568,9301173,15954343,16415157,59387901,17451223,63374715,5718980,16345411,40654494,158566856,45495678,22122301,96759749,4437796,26413781,16291165,71968647,1930925,119262084,39738847,30973953,91840127,39717063,24012105,17539412,31773898,19639198,17467078,44756576,116482814,15903088,19859837,7327038,12670437,19655242,145354365,138262284,116356065,21466521,7928604,18153096,64689347,7061492,12758789,35096987,6318074,75107726,67903404,105215538,23798909,4519975,99525218,992886,73109648,43828414,49354288,89606541,22264486,33665905,20296413,65286238,4725763,24780253,42272477,42941845,29712546,2934586,42043874,62965468,11109943,26851141,8501211,48186737,120603116,28424345,9575304,21866959,866068,73645259,58599316,84006154,32463837,56416166,15402930,5592048,49812433,9178192,70724959,89709440,92115332,51726973,18856907,25607565,40519634,1849535,33276309,53133223,23284338,47314124,110193333,5089889,89696745,17450836,23916990,37835400,22678065,35441971,38700319,6636624,44226054,32159205,4594699,117917140,10805825,142233961,5253540,103635810,92874494,51564311,54967854,55553849,21019664,15649638,22303597,18036421,17022900,46661621,5266506,18647783,73310216,95634921,73796153,14422241,40723773,203342505,14476900,19101285,13007726,39967002,17314583,24587135,16692848,7582888,68244053,56345667,36802345,1651582,110821202,9912012,88321512,7898429,30325786,36953736,77665825,196714666,1545341,53038431,24679466,201349504,48011815,107269776,40064972,2164852,50412447,69477,150180586,21189820,13285166,36943813,103419423,35116470,219311911,72545766,31471324,16039081,105402969,89177556,10581593,23846470,14692842,8032762,6849668,8011176,196871282,198961231,13098077,58944311,61769532,38100602,86486285,7675610,40662503,39272441,3491694,33301841,59184055,66662584,100059167,28522116,15787411,40279775,54531544,55342237,43123393,78776236,106548372,208724157,33119164,132297844,19109677,15646553,24048088,11595359,72064340,64634397,4220769,39280096,4488633,55898922,815970,60271595,12993757,30894261,54073724,18511246,40699223,45528774,28619401,20740665,25789156,45031451,171457052,49825239,169616258,95519901,3888029,16121890,59572629,47856230,20250143,18097840,18719531,69239224,7194143,137041955,9662377,39279389,45368235,80659877,67512910,31216985,39435007,8424972,170633594,118673296,114026379,1286560,109552487,144602393,18774537,57396437,13966993,28154628,89505641,1126557,29027878,24458013,38627587,31880191,31871858,1213962,47079265,43714711,208230752,17210038,3187149,4374205,5563047,7114604,83086528,16270829,46572061,37330185,121060963,4200928,50408696,16057186,40765846,7025159,121181,45941621,40259823,8450512,42119351,65480785,18681564,33467875,118011676,22965552,42874367,102555583,45908027,9802318,19261363,51951102,1321626,36384343,63406535,22431029,17242442,22892090,22866817,71551053,99556026,2410361,1676311,34286946,33257030,21750167,1362331,30645446,15547305,85319291,115833409,5402543,6668772,29312119,8162121,36082545,41718207,108615012,98939319,6531597,33212925,28129736,35472206,67448163,7874032,8299916,20881817,29554424,1699613,75622598,42804964,3891651,54439877,5557597,9979355,41668204,28784613,3919268,37314321,6972582,11195596,23840126,8919360,50460490,42940936,50771501,81528042,23948023,15813095,24372667,81505803,3901513,9898307,21933481,61891842,49345804,44685172,144526075,59332366,236144436,93465228,169726604,24991894,37257604,17877663,44926434,4104951,13421475,61089603,15976696,33127264,40663807,141956670,33042648,5126041,59102390,21288460,5982960,142105419,175218885,21091838,55992749,46483572,54493295,330183670,132880338,36468920,12567493,56040569,23143626,69105999,1273281,45129437,34277945,33877106,35541080,28355578,11877885,19410951,76688137,68838026,38794191,70882064,22845431,9769319,7201046,1855080,11551146,185667569,20076283,11634136,35044607,66622816,39643204,40002783,2414479,7569550,9315409,7359208,103187215,61627551,40021759,91631009,19852012,62771048,19933561,15365006,19239826,106333500,41526293,65320633,70260887,115876863,16058629,16457106,119640240,40853348,112041998,34425981,6433782,144790602,4171612,20964306,104722527,26012301,36789149,10935389,80343544,2222507,26627433,4178739,16409553,97660987,46685533,35424645,40496650,109458777,37201712,22820103,83470241,79891419,71466250,12678979,45589840,2364290,4032919,62507455,3835329,68687900,50166747,270773604,72349433,4386945,176305655,14444404,26589345,24680968,49732618,39919167,25601251,57222993,46588698,14430381,8840946,17761549,57202857,12655551,17416363,145182539,51889155,37112819,27242440,30617024,45312276,12958088,1691072,64361052,7124544,145351938,18086854,172835706,13517741,190603277,18675365,58276741,94747420,41590533,47084974,94153882,63682939,34630323,11520509,18896420,27437278,5972180,37255820,24511788,75100777,12249741,8808919,5837515,20712913,106302652,14852933,8261646,144314944,26903518,38668359,33470146,15107493,12900208,75874840,71824466,148378540,33494845,144184090,44808093,21869034,44934064,31948110,46554523,26641832,54207721,45881002,6365414,94442635,34117198,8603101,12634114,99833369,127111410,15998115,21385364,137279889,9941441,73491396,22817624,76187669,21579921,11848829,23554322,52080147,8924541,23858566,159174693,40916661,59777363,104736977,88623985,11483143,72315891,21657493,14787377,102983920,27032652,9111463,97433294,6966612,6106823,28403747,80404088,31838214,18209712,16090768,19307109,17438633,7317391,17551066,30492577,43521737,6812657,5051807,40125920,68582514,14605950,38934768,21251320,28477370,7205137,1790740,14216485,33386969,68370302,15173639,59995359,72529845,10238426,16073987,30301953,84316681,31225883,146932331,43902989,26472002,54451170,17730816,42326083,41468242,94312776,27861310,12944873,27899531,23437901,35434245,35890196,55500290,15596084,20316215,1416250,32970732,44185091,7207433,16426234,1402432,27500602]

fp = np.array(fp)

secfp = np.array([0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0], dtype=np.uint8)

def test_shingling_from_mol():
    assert sorted(mhfp_encoder.shingling_from_mol(mol)) == shingling

def test_shingling_from_smiles():
    assert sorted(mhfp_encoder.shingling_from_smiles(smiles, sanitize=True)) == shingling

def test_from_molecular_shingling():
    assert np.array_equal(mhfp_encoder.from_molecular_shingling(shingling), fp)

def test_distance():
    fp_a = mhfp_encoder.from_molecular_shingling(mhfp_encoder.shingling_from_smiles('CCOC1=C(C=C(C=C1)S(=O)(=O)N(C)C)C2=NC(=O)C3=C(N2)C(=NN3C)C(C)(C)C', sanitize=True))
    fp_b = mhfp_encoder.from_molecular_shingling(mhfp_encoder.shingling_from_smiles('CCCC1=NN(C2=C1NC(=NC2=O)C3=C(C=CC(=C3)S(=O)(=O)N4CCN(CC4)C)OCC)C', sanitize=True))
    fp_c = mhfp_encoder.from_molecular_shingling(mhfp_encoder.shingling_from_smiles('O=C(OC)C(C1CCCCN1)C2=CC=CC=C2', sanitize=True))
    assert MHFPEncoder.distance(fp, fp_b) == 0.0
    assert MHFPEncoder.distance(fp, fp_a) == 0.45849609375
    assert MHFPEncoder.distance(fp, fp_c) == 0.97216796875

    assert MHFPEncoder.distance(fp, fp_b) == jaccard(fp, fp_b)
    assert MHFPEncoder.distance(fp, fp_a) == jaccard(fp, fp_a)
    assert MHFPEncoder.distance(fp, fp_c) == jaccard(fp, fp_c)


def test_encode():
    assert np.array_equal(mhfp_encoder.encode(smiles, sanitize=True), fp)

def test_encode_mol():
    assert np.array_equal(mhfp_encoder.encode_mol(mol), fp)


def test_secfp():
    assert np.array_equal(MHFPEncoder.secfp_from_smiles(smiles), secfp)