\documentclass[SE,toc]{lsstdoc}

% We use commands to make it easy to find where parameter names and units
% are defined in the tables, and to allow hyphenation.
\newcommand{\paramname}[1]{\hspace{0pt}#1}
\newcommand{\unitname}[1]{\hspace{0pt}#1}

\setcounter{secnumdepth}{5}

%% Retrieve date and model version
\setDocUpstreamLocation{MagicDraw SysML}
\setDocUpstreamVersion{342 (2017-08-21)}

\date{2017-09-12}

%% Define the document title, authors, handle, and change record
\input metadata.tex

% Environment for displaying the parameter tables in
% a consistent manner. No arguments as there are no
% captions or labels.
\newenvironment{parameters}[0]{%
\setlength\LTleft{0pt}
\setlength\LTright{\fill}
\begin{small}
\begin{longtable}[]{|p{0.49\textwidth}|l|p{0.6in}|p{1.70in}@{}|}

\hline \textbf{Description} & \textbf{Value} & \textbf{Unit} & \textbf{Name} \\ \hline
\endhead

\hline \multicolumn{4}{r}{\emph{Continued on next page}} \\
\endfoot

\hline\hline
\endlastfoot
}{%
\hline
\end{longtable}
\end{small}
}

\begin{document}
\maketitle

This document contains the top-level requirements for the Data Management subsystem of the LSST, when combined with the Data Management-related requirements in the LSST System Requirements (LSR, \citeds{LSE-29}) and Observatory System Specifications (OSS, \citeds{LSE-30}).

\textbf{Supporting Documents}

    \begin{enumerate}
\item
LSST Science Requirements Document (document \citeds{LPM-17})

\item
LSST System Requirements (document \citeds{LSE-29})

\item
LSST Observatory System Specifications (document \citeds{LSE-30})

\item
LSST Document Tree (document \citeds{LSE-39})

    \end{enumerate}

\textbf{Definition of Terms:}

In this document a \textbf{\textit{requirement}} refers to a declaration of a specified function or quantitative performance that the delivered system or subsystem must meet. It is a statement that identifies a necessary attribute, capability, characteristic, or quality of a system in order for the delivered system or subsystem to meet a derived or higher requirement, constraint, or function.

This document uses the term \textbf{\textit{specification(s)}} to mean one or more performance parameter(s) being established by a requirement that the delivered system or subsystem must meet.

An \textbf{\textit{attribute}} specifies a quantitative performance \textbf{\textit{parameter}} in the context of the SysML based SysArch model used to generate this document.

A \textbf{\textit{constraint}} is used to refer to an external limitation imposed on a delivered item under which it must meet its requirements (e.g., the survey performance must be met under the constraint of the historical weather pattern of the chosen site). A constraint in not a characteristic the system or subsystem itself possesses.

\textbf{Verb Usage:}

Statements of need, requirements, and constraints are written using one of three verbs that have a specific meaning with respect to verification. All statements in this specification that convey operational, functional, or performance needs, requirements, constraints, or goals on the LSST system will contain one of these three verbs.

    \begin{itemize}
\item
\textbf{Will} – A statement of fact. Will statements document something that will occur through the course of normal design practice, project process, etc. These statements do not get formally verified.

\item
\textbf{Should} – A goal. Should statements document a stretch goal. A should statement is typically partnered with a shall statement. Should statements do not get formally verified.

\item
\textbf{Shall - }A requirement that gets formally verified. Shall statements document critical requirements that must be verified through inspection, demonstration, analysis, or test during the verification phase of the project to ensure objectively that the as-built design meets the requirement.

    \end{itemize}

 \textbf{Prioritization:}

    \begin{enumerate}
\item
 "This must be done to enter commissioning (a) or operations (b); no waivers will be granted if not met."
        \begin{itemize}
\item
\textbf{1a:} Must be demonstrated to be working before the start of the commissioning period.

\item
\textbf{1b:} Must be demonstrated to be working before the start of the observing.

        \end{itemize}

\item
"Should be done to enter Operations; but waiver likely to be granted if not met," i.e., we could enter Operations without this fulfilled, for first 3 years.

\item
"Overall capability/efficiency/ease of use/etc., may be reduced but science will not critically suffer if not done." Could enter operations without this requirement fulfilled, and have the operations team decide whether they want to pursue it.

    \end{enumerate}

\section{Data Products}

\subsection{General Considerations}

\subsubsection{Data Availability}

\label{DMS-REQ-0346}
\textbf{ID:} DMS-REQ-0346 (Priority: 1b)

\textbf{Specification: }All raw data used to generate any public data product (raw exposures, calibration frames, telemetry, configuration metadata, etc.) shall be kept and made available for download.

\emph{Derived from Requirements:}

OSS-REQ-0004:
The Archive Facility \newline
OSS-REQ-0167:
Data Archiving \newline
OSS-REQ-0313:
Telemetry Database Retention \newline

\subsubsection{Measurements in catalogs}

\label{DMS-REQ-0347}
\textbf{ID:} DMS-REQ-0347 (Priority: 1b)

\textbf{Specification: }All catalogs shall record source measurements in flux units.

\textbf{Discussion: }Difference measurements can go negative and in multi-epoch surveys averaging of fluxes rather than magnitudes is required. This requirement does not preclude making magnitudes available where appropriate.

\subsubsection{Computing Derived Quantities}

\label{DMS-REQ-0331}
\textbf{ID:} DMS-REQ-0331 (Priority: 1b)

\textbf{Specification:} Common derived quantities shall be made available to end-users by either providing pre-computed columns or providing functions that can be used dynamically in queries. These should at least include the ability to calculate the reduced chi-squared of fitted models and make it as easy as possible to calculate color-color diagrams.

\textbf{Discussion:} Example quantities include those used to assess model fit quality or those required for calculating color-magnitude diagrams. Care should be taken to name the derived columns in a clear unambiguous way.

\subsubsection{Denormalizing Database Tables}

\label{DMS-REQ-0332}
\textbf{ID:} DMS-REQ-0332 (Priority: 2)

\textbf{Specification:} The database tables shall contain views presented to the users that will be appropriately denormalized for ease of use.

\subsubsection{Maximum Likelihood Values and Covariances}

\label{DMS-REQ-0333}
\textbf{ID:} DMS-REQ-0333 (Priority: 1b)

\textbf{Specification:} Quantities delivered by all measurement algorithms shall include maximum likelihood values and covariances.

\textbf{Discussion:} Algorithms for which such values are impossible, will be documented explicitly to declare that the values are unavailable.

\subsubsection{Storing Approximations of Per-pixel Metadata}

\label{DMS-REQ-0326}
\textbf{ID:} DMS-REQ-0326 (Priority: 2)

\textbf{Specification:} Image depth and mask information shall be available in a parametrized approximate form in addition to a full per-pixel form.

\textbf{Discussion:} This parametrization could be in formats such as MOC, Mangle polygons or STC regions.

\subsection{Data Acquisition}

\subsubsection{Raw Image Assembly}

\label{DMS-REQ-0024}
\textbf{ID:} DMS-REQ-0024 (Priority: 1a)

\textbf{Specification:} The DMS shall assemble the combination of raw exposure data from all the readout channels from a single Sensor to form a single image for that sensor. The image data and relevant exposure metadata shall be integrated into a standard format suitable for down-stream processing, archiving, and distribution to the user community.

\textbf{Discussion:} Relevant exposure metadata are those that define the observing context, telescope and instrument configuration, and provenance.

\emph{Derived from Requirements:}

OSS-REQ-0114:
Acquisition of Science Sensor data \newline
OSS-REQ-0129:
Exposures (Level 1) \newline

\subsubsection{Raw Science Image Data Acquisition}

\label{DMS-REQ-0018}
\textbf{ID:} DMS-REQ-0018 (Priority: 1a)

\textbf{Specification:} The DMS shall acquire raw Exposure data from the Camera science sensors during normal operations, calibration data collection, and in any other required engineering modes.

\textbf{Discussion:} The manner of data acquisition is a matter for the DM-Camera ICDs, \citeds{LSE-69} and \citeds{LSE-68}, in this area.

\emph{Derived from Requirements:}

OSS-REQ-0114:
Acquisition of Science Sensor data \newline

\subsubsection{Raw Science Image Metadata}

\label{DMS-REQ-0068}
\textbf{ID:} DMS-REQ-0068 (Priority: 1a)

\textbf{Specification:} For each raw science image, the DMS shall store image metadata including at least:
\begin{itemize}
\item Time of exposure start and end, referenced to TAI, and DUT1
\item Site metadata (site seeing, transparency, weather, observatory location)
\item Telescope metadata (telescope pointing, active optics state, environmental state)
\item Camera metadata (shutter trajectory, wavefront sensors, environmental state)
\end{itemize}

\emph{Derived from Requirements:}

OSS-REQ-0122:
Provenance \newline
\hyperref[DMS-REQ-0066]{DMS-REQ-0066}:
Keep Exposure Archive \newline
OSS-REQ-0171:
Engineering and Facilities Data \newline

\subsubsection{Crosstalk Corrected Science Image Data Acquisition}

\label{DMS-REQ-0022}
\textbf{ID:} DMS-REQ-0022 (Priority: 2)

\textbf{Specification:} The DMS shall acquire crosstalk corrected exposure data from the Camera science sensors, during normal survey operations and in any other required operating modes.

\textbf{Discussion:} The manner of data acquisition is a matter for the DM-Camera ICD in this area.  It may be different for that for the raw science sensor data, as it is subject to quite different latency and reliability requirements.

This data is the input to the main Alert Production pipelines.  It is not planned to be archived.

\emph{Derived from Requirements:}

OSS-REQ-0114:
Acquisition of Science Sensor data \newline
OSS-REQ-0127:
Level 1 Data Product Availability \newline

\subsubsection{Wavefront Sensor Data Acquisition}

\label{DMS-REQ-0020}
\textbf{ID:} DMS-REQ-0020 (Priority: 1a)

\textbf{Specification:} The DMS shall acquire raw exposure data from the Camera wavefront sensors, during normal survey operations and in any other required operating modes.

\textbf{Discussion:} The details of this are a matter for the DM-Camera ICD in this area. However, these data should be identical in format and in mode of acquisition to the raw science sensor data.

There is no currently established requirement for the acquisition or archiving of any raw guider sensor data.

\emph{Derived from Requirements:}

OSS-REQ-0316:
Wavefront Sensor Data \newline

\subsubsection{Guider Calibration Data Acquisition}

\label{DMS-REQ-0265}
\textbf{ID:} DMS-REQ-0265 (Priority: 1a)

\textbf{Specification:} The DMS shall acquire raw, full-frame exposures from the camera guider sensors during calibration. The DMS shall produce calibration data products for the guide sensors.

\emph{Derived from Requirements:}

OSS-REQ-0194:
Calibration Exposures Per Day \newline

\subsection{Level 1 Data Products}

\subsubsection{Nightly Data Accessible Within 24 hrs}

\label{DMS-REQ-0004}
\textbf{ID:} DMS-REQ-0004 (Priority: 1b)

\textbf{Specification:} With the exception of alerts and Solar System Objects, all Level 1 Data Products shall be made public within time \textbf{L1PublicT} (LSR-REQ-0104) of the acquisition of the raw image data. Alerts shall be made available within time \textbf{OTT1} (LSR-REQ-0101) from the conclusion of readout of the raw exposures used to generate each alert to the distribution of the alert to community distribution mechanisms.  Solar System Object orbits shall, on average, be calculated before the following night's observing finishes and the results shall be made available within time \textbf{L1PublicT} of those calculations being completed.

\textbf{Discussion:} Because of the processing flow of SSObject orbit determination, meeting the base 24-hours-after-data-acquisition requirement would be far more challenging than for the other L1 Data Products, but the system throughput has to be good enough such that a back log can not build up.

\begin{parameters}
Maximum time from the acquisition of science data to the public release of associated Level 1 Data Products (except alerts)
&
24
&
\unitname{%
hour
}
&
\paramname{%
L1PublicT
} \\\hline
The latency of reporting optical transients following the completion of readout of the last image of a visit
&
1
&
\unitname{%
minute
}
&
\paramname{%
OTT1
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0003]{DMS-REQ-0003}:
Create and Maintain Science Data Archive  \newline
OSS-REQ-0127:
Level 1 Data Product Availability \newline

\subsubsection{Processed Visit Images}

\label{DMS-REQ-0069}
\textbf{ID:} DMS-REQ-0069 (Priority: 1a)

\textbf{Specification: }The DMS shall produce Processed Visit Images, in which the corresponding raw sensor array data has been trimmed of overscan and corrected for instrumental signature. Images obtained in pairs during a standard visit are combined.

\textbf{Discussion:} Processed science exposures are not archived, and are retained for only a limited time to facilitate down-stream processing. They will be re-generated for users on-demand using the latest processing software and calibrations.

This aspect of the processing for Special Programs data is specific to each program.

\emph{Derived from Requirements:}

OSS-REQ-0129:
Exposures (Level 1) \newline

\paragraph{Background Model Calculation}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0327}
\textbf{ID:} DMS-REQ-0327 (Priority: 1b)

\textbf{Specification: }The DMS shall derive and persist a background model (both due to night sky and astrophysical) for each visit image, per CCD.

\emph{Derived from Requirements:}

OSS-REQ-0056:
System Monitoring \& Diagnostics \newline

\paragraph{Generate Photometric Zeropoint for Visit Image}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0029}
\textbf{ID:} DMS-REQ-0029 (Priority: 1b)

\textbf{Specification:} The DMS shall derive and persist a photometric zeropoint for each visit image, per CCD.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0090]{DMS-REQ-0090}:
Generate Alerts \newline
OSS-REQ-0056:
System Monitoring \& Diagnostics \newline
OSS-REQ-0152:
Level 1 Photometric Zero Point Error \newline

\paragraph{Generate PSF for Visit Images}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0070}
\textbf{ID:} DMS-REQ-0070 (Priority: 1b)

\textbf{Specification:} The DMS shall determine a characterization of the PSF for any specified location in Processed Visit Images.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0116]{DMS-REQ-0116}:
Extended Object Shape Parameters \newline
OSS-REQ-0056:
System Monitoring \& Diagnostics \newline

\paragraph{Generate WCS for Visit Images}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0030}
\textbf{ID:} DMS-REQ-0030 (Priority: 1a)

\textbf{Specification:} The DMS shall generate and persist a WCS for each visit image.  The absolute accuracy of the WCS shall be at least \textbf{astrometricAccuracy} in all areas of the image, provided that there are at least \textbf{astrometricMinStandards} astrometric standards available in each CCD.

\textbf{Discussion:} The World Coordinate System for visits will be expressed in terms of a FITS Standard representation, which provides for named metadata to be interpreted as coefficients of one of a finite set of coordinate transformations.

\begin{parameters}
Absolute accuracy of the WCS across the focal plane (approximately one-quarter of a pixel).
&
50
&
\unitname{%
milliarcsecond
}
&
\paramname{%
astrometricAccuracy
} \\\hline
Minimum number of astrometric standards per CCD.
&
5
&
\unitname{%
integer
}
&
\paramname{%
astrometricMinStandards
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0104]{DMS-REQ-0104}:
Produce Co-Added Exposures \newline
\hyperref[DMS-REQ-0090]{DMS-REQ-0090}:
Generate Alerts \newline
OSS-REQ-0162:
Level 2 Catalog Accuracy \newline
OSS-REQ-0149:
Level 1 Catalog Precision \newline

\paragraph{Documenting Image Characterization}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0328}
\textbf{ID:} DMS-REQ-0328 (Priority: 1b)

\textbf{Specification:} The persisted format for Processed Visit Images shall be fully documented, and shall include a description of all image characterization data products.

\textbf{Discussion:} This will allow the community to use them to increase understanding of LSST images and derived LSST catalogs.

\paragraph{Processed Visit Image Content}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0072}
\textbf{ID:} DMS-REQ-0072 (Priority: 1a)

\textbf{Specification:} Processed visit images shall include the corrected science pixel array, an integer mask array where each bit-plane represents a logical statement about whether a particular detector pathology affects the pixel, a variance array which represents the expected variance in the corresponding science pixel, and a representation of the spatially varying PSF that applies over the extent of the science array. These images shall also contain metadata that map pixel to world (sky) coordinates (the WCS) as well as metadata from which photometric measurements can be derived.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0066]{DMS-REQ-0066}:
Keep Exposure Archive \newline
OSS-REQ-0129:
Exposures (Level 1) \newline

\subsubsection{Difference Exposures}

\label{DMS-REQ-0010}
\textbf{ID:} DMS-REQ-0010 (Priority: 1b)

\textbf{Specification:} The DMS shall create a Difference Exposure from each Processed Visit Image by subtracting a re-projected, scaled, PSF-matched Template Image in the same passband.

\textbf{Discussion:} Difference Exposures are not archived, and are retained for only a limited time to facilitate Alert processing. They can be re-generated for users on-demand.

\emph{Derived from Requirements:}

OSS-REQ-0129:
Exposures (Level 1) \newline
\hyperref[DMS-REQ-0011]{DMS-REQ-0011}:
Produce Difference Sources \newline
\hyperref[DMS-REQ-0033]{DMS-REQ-0033}:
Provide Source Detection Software \newline

\paragraph{Difference Exposure Attributes}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0074}
\textbf{ID:} DMS-REQ-0074 (Priority: 1b)

\textbf{Specification:} For each Difference Exposure, the DMS shall store: the identify of the input exposures and related provenance information, and a set of metadata attributes including at least a representation of the PSF matching kernel used in the differencing.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0066]{DMS-REQ-0066}:
Keep Exposure Archive \newline
OSS-REQ-0122:
Provenance \newline

\subsubsection{Exposure Catalog}

\label{DMS-REQ-0266}
\textbf{ID:} DMS-REQ-0266 (Priority: 1a)

\textbf{Specification:} The DMS shall create an Exposure Catalog containing information for each exposure that includes the exposure date/time and duration, properties of the filter used, dome and telescope pointing and orientation, status of calibration apparatus, airmass and zenith distance, telescope and dome status, environmental information, and information regarding each sensor including an ID, its location in the focal plane, electronic configuration, and WCS.

\emph{Derived from Requirements:}

OSS-REQ-0130:
Catalogs (Level 1) \newline

\subsubsection{DIASource Catalog}

\label{DMS-REQ-0269}
\textbf{ID:} DMS-REQ-0269 (Priority: 1b)

\textbf{Specification:} The DMS shall construct a catalog of all Sources detected on Difference Exposures with SNR > \textbf{transSNR}. For each Difference Source (DIASource), the DMS shall be able to provide the identity of the Difference Exposure from which it was derived; the identity of the associated SSObject, if any; the identity of the parent Source from which this DIASource has been deblended, if any. The DMS shall also measure and record a set of attributes for each DIASource including at least: epoch of the observation, focal plane position centroid and error (pixel), sky position and associated error (radec), SNR of the detection; calibrated PS flux and associated error; likelihood of the observed data given the PS model; calibrated aperture flux and associated error; calibrated flux and associated error for a trailed source model, and length and angle of the trail; flux and associated parameters for a dipole model; parameters of an adaptive shape measurement and associated error; a measure of source extendedness; the estimated background at the position of the object in the template image with associated uncertainty; a measure of spuriousness; and flags indicating problems encountered while computing the aforementioned attributes. The DMS shall also determine and record measurements on the Calibrated exposure the following: calibrated flux and associated error for the source as measured on the Visit image.

\begin{parameters}
The signal-to-noise ratio in single-visit difference images above which all optical transients are to be reported.
&
5
&
\unitname{%
float
}
&
\paramname{%
transSNR
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0130:
Catalogs (Level 1) \newline
\hyperref[DMS-REQ-0270]{DMS-REQ-0270}:
Faint DIASource Measurements \newline

\subsubsection{Faint DIASource Measurements}

\label{DMS-REQ-0270}
\textbf{ID:} DMS-REQ-0270 (Priority: 2)

\textbf{Specification:} The DMS shall be able to measure and store DIASources fainter than \textbf{transSNR }that satisfy additional criteria. A limited number of such sources shall be made to enable monitoring of DIA quality.

\textbf{Discussion: }Some individual faint sources may be of high significance, such as a potentially hazardous asteroid.

\begin{parameters}
The signal-to-noise ratio in single-visit difference images above which all optical transients are to be reported.
&
5
&
\unitname{%
float
}
&
\paramname{%
transSNR
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0166:
Alert Completeness and Purity \newline

\subsubsection{Characterizing Variability}

\label{DMS-REQ-0319}
\textbf{ID:} DMS-REQ-0319 (Priority: 1b)

\textbf{Specification:} For alert production, DIAObject variability characterization shall include data collected during the time period from the present to at least \textbf{diaCharacterizationCutoff} in the past.

\textbf{Discussion:} These measurements can come from the live L1 database. For level 1 processing during Data Release Production, all data should be used for characterization.

\begin{parameters}
Time-period to use for characterizing variability in L1 system.
&
1
&
\unitname{%
year
}
&
\paramname{%
diaCharacterizationCutoff
} \\\hline
\end{parameters}

\subsubsection{DIAObject Catalog}

\label{DMS-REQ-0271}
\textbf{ID:} DMS-REQ-0271 (Priority: 1b)

\textbf{Specification:} The DMS shall construct a catalog of all astrophysical objects identified through difference image analysis (DIAObjects). The DIAObject entries shall include metadata attributes including at least: a unique identifier; the identifiers of the\textbf{ diaNearbyObjMaxStar} nearest stars and \textbf{diaNearbyObjMaxGalaxy} nearest galaxies in the Object catalog lying within \textbf{diaNearbyObjRadius}, the probability that the DIAObject is the same as the nearby Object; and a set of DIAObject properties.

\begin{parameters}
Maximum number of nearby galaxies that can be associated with a DIASource.
&
3
&
\unitname{%
integer
}
&
\paramname{%
diaNearbyObjMaxGalaxy
} \\\hline
Maximum number of stars that can be associated with a DIASource.
&
3
&
\unitname{%
integer
}
&
\paramname{%
diaNearbyObjMaxStar
} \\\hline
Radius within which an Object is considered to be near, and possibly coincident with, the DIASource.
&
60
&
\unitname{%
arcsecond
}
&
\paramname{%
diaNearbyObjRadius
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0130:
Catalogs (Level 1) \newline

\paragraph{DIAObject Attributes}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0272}
\textbf{ID:} DMS-REQ-0272 (Priority: 1b)

\textbf{Specification:} For each DIAObject the DMS shall store summary attributes including at least: sky position at the time of the observation; astrometric attributes including proper motion, parallax and related errors; point-source magnitude in each passband and related error; weighted mean forced-photometry flux and related error; periodic and non-periodic variability measures; and flags that encode special conditions encountered in measuring the above quantities.

\emph{Derived from Requirements:}

OSS-REQ-0130:
Catalogs (Level 1) \newline

\subsubsection{SSObject Catalog}

\label{DMS-REQ-0273}
\textbf{ID:} DMS-REQ-0273 (Priority: 2)

\textbf{Specification:} The DMS shall produce a catalog of all Solar System Objects (SSObjects) that have been identified via Moving Object Processing. The SSObject catalog shall include for each entry attributes including at least the following: Osculating orbital elements and associated uncertainties, minimum orbit intersection distance (MOID), mean absolute magnitude and slope parameter per band and associated errors, and flags that describe conditions of the description.

\textbf{Discussion: }The magnitude and angular velocity limits for identifying SSObjects are TBD. These limits may be driven more by computational resource constraints than by the raw reach of the collected data. The software may well be capable of exceeding the required limits, but at an unacceptable cost. The slope parameter will be poorly constrained until later in the survey. A baseline algorithm and acceptance criteria should be developed prior to verification.

\emph{Derived from Requirements:}

OSS-REQ-0130:
Catalogs (Level 1) \newline

\subsubsection{Calculating SSObject Parameters}

\label{DMS-REQ-0323}
\textbf{ID:} DMS-REQ-0323 (Priority: 3)

\textbf{Specification:} The LSST database shall provide functions to compute, for every SSObject, the phase angle for every observation, and the reduced and absolute asteroid magnitudes in all LSST bands.

\subsubsection{DIAForcedSource Catalog}

\label{DMS-REQ-0317}
\textbf{ID:} DMS-REQ-0317 (Priority: 2)

\textbf{Specification:} The DMS shall create a DIAForcedSource Catalog, consisting of measured fluxes for entries in the DIAObject Catalog on Difference Exposures. Measurements for each forced-source shall include the DIAObject and visit IDs, the modeled flux and error (given fixed position, shape, and deblending parameters), and measurement quality flags.

\textbf{Discussion: }The large number of such forced sources makes it impractical to measure more attributes than are necessary to construct a light curve for variability studies.

\emph{Derived from Requirements:}

OSS-REQ-0130:
Catalogs (Level 1) \newline

\subsubsection{Matching DIASources to Objects}

\label{DMS-REQ-0324}
\textbf{ID:} DMS-REQ-0324 (Priority: 1b)

\textbf{Specification:} A L1 DIASource to L2 Object positional cross-match table or database view shall be made available.

\textbf{Discussion:} Care should be taken to note that this is purely a cross-match based on separation on the sky and does not imply the DIASource and Object are physically the same.

\subsubsection{Alert Content}

\label{DMS-REQ-0274}
\textbf{ID:} DMS-REQ-0274 (Priority: 1b)

\textbf{Specification:} The DMS shall create an Alert for each detected DIASource, to be broadcast using community protocols, with content that includes: a unique Alert ID, the Level-1 database ID, the DIASource record that triggered the alert, the DIAObject (or SSObject) record, all previous DIASource records corresponding to the object (if any), and cut-outs of images (from both the template image and the difference image) of sufficient areal coverage to identify the DIASource and its immediate surroundings. These cutouts should include WCS, PSF, variance and mask information.

\textbf{Discussion: }The aim for the Alert content is to include sufficient information to be relatively self-contained, and to minimize the demand for follow-up queries of the Level-1 database. This approach will likely increase the speed and efficiency of down-stream object classifiers.

\emph{Derived from Requirements:}

OSS-REQ-0128:
Alerts \newline

\subsubsection{Level 1 Data Quality Report Definition}

\label{DMS-REQ-0097}
\textbf{ID:} DMS-REQ-0097 (Priority: 1a)

\textbf{Specification:} The DMS shall produce a Level 1 Data Quality Report that contains indicators of data quality that result from running the DMS pipelines, including at least: Photometric zero point vs. time for each utilized filter; Sky brightness vs. time for each utilized filter; seeing vs. time for each utilized filter; PSF parameters vs. time for each utilized filter; detection efficiency for point sources vs. mag for each utilized filter.

\textbf{Discussion:} The seeing report is intended as a broad-brush measure of image quality.  The PSF parameters provide more detail, as they include asymmetries and field location dependence.

\emph{Derived from Requirements:}

OSS-REQ-0131:
Nightly Summary Products \newline
\hyperref[DMS-REQ-0096]{DMS-REQ-0096}:
Generate Data Quality Report Within Specified Time \newline

\subsubsection{Level 1 Performance Report Definition}

\label{DMS-REQ-0099}
\textbf{ID:} DMS-REQ-0099 (Priority: 1b)

\textbf{Specification:} The DMS shall produce a Level 1 Performance Report that provides indicators of how the DMS has performed in processing the night's observations, including at least: number of observations successfully processed through each pipeline; number of observations for each pipeline that had recoverable failures (with a record of the failure type and recovery mechanism); number of observations for each pipeline that had unrecoverable failures; number of observations archived at each DMS Facility; number of observations satisfying the science criteria for each active science program.

\emph{Derived from Requirements:}

OSS-REQ-0131:
Nightly Summary Products \newline
\hyperref[DMS-REQ-0098]{DMS-REQ-0098}:
Generate DMS Performance Report Within Specified Time \newline

\subsubsection{Level 1 Calibration Report Definition}

\label{DMS-REQ-0101}
\textbf{ID:} DMS-REQ-0101 (Priority: 1a)

\textbf{Specification:} The DMS shall produce a Level 1 Calibration Report that provides a summary of significant differences in Calibration Images that may indicate evolving problems with the telescope or camera, including a nightly broad-band flat in each filter.

\emph{Derived from Requirements:}

OSS-REQ-0131:
Nightly Summary Products \newline
\hyperref[DMS-REQ-0100]{DMS-REQ-0100}:
Generate Calibration Report Within Specified Time \newline

\subsubsection{Regenerating L1 Data Products During Data Release Processing}

\label{DMS-REQ-0325}
\textbf{ID:} DMS-REQ-0325 (Priority: 2)

\textbf{Specification:} During Data Release Processing, all the Level 1 data products shall be regenerated using the current best algorithms.

\textbf{Discussion:} Variability characterization will use the full light curve history.

\emph{Derived from Requirements:}

OSS-REQ-0135:
Uniformly calibrated and processed versions of Level 1 Data Products \newline

\subsubsection{Publishing predicted visit schedule}

\label{DMS-REQ-0353}
\textbf{ID:} DMS-REQ-0353 (Priority: 1b)

\textbf{Specification:}
A service shall be provided to publish to the community the next visit location and the predicted visit schedule provided by the OCS. This service shall consist of both a web page for human inspection and a web API to allow automated tools to respond promptly.

\textbf{Discussion:}
The next visit and advanced schedule do not need to be published using the same service or protocol.

\emph{Derived from Requirements:}

OSS-REQ-0378:
Advanced Publishing of Scheduler Sequence \newline

\subsection{Level 2 Data Products}

\subsubsection{Persisting Data Products}

\label{DMS-REQ-0334}
\textbf{ID:} DMS-REQ-0334 (Priority: 1b)

\textbf{Specification:}
All per-band deep coadds and best seeing coadds shall be kept indefinitely and made available to users.

\textbf{Discussion:} This requirement is intended to list all the data products that must be archived rather than regenerated on demand. \hyperref[DMS-REQ-0069]{DMS-REQ-0069} indicates in discussion that Processed Visit Images are not archived. \hyperref[DMS-REQ-0010]{DMS-REQ-0010} indicates in the discussion that Difference Exposures are not archived.

\emph{Derived from Requirements:}

OSS-REQ-0136:
Co-added Exposures \newline

\subsubsection{Source Catalog}

\label{DMS-REQ-0267}
\textbf{ID:} DMS-REQ-0267 (Priority: 1b)

\textbf{Specification:} The DMS shall create a Catalog containing all Sources detected in single (standard) visits and on Co-Adds, and will contain an identifier of the Exposure on which the Source was detected, as well as measurements of Source Attributes. The measured attributes (and associated errors) include location on the focal plane; a static point-source model fit to world coordinates and flux; a centroid and adaptive moments; and surface brightnesses through elliptical multiple apertures that are concentric, PSF-homogenized, and logarithmically spaced in intensity.

\emph{Derived from Requirements:}

OSS-REQ-0137:
Catalogs (Level 2) \newline

\subsubsection{Object Catalog}

\label{DMS-REQ-0275}
\textbf{ID:} DMS-REQ-0275 (Priority: 1b)

\textbf{Specification:} The DMS shall create an Object Catalog, based on sources deblended based on knowledge of CoaddSource, DIASource, DIAObject, and SSObject Catalogs, after multi-epoch spatial association and characterization.

\emph{Derived from Requirements:}

OSS-REQ-0137:
Catalogs (Level 2) \newline

\paragraph{Provide Photometric Redshifts of Galaxies}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0046}
\textbf{ID:} DMS-REQ-0046 (Priority: 2)

\textbf{Specification:} The DMS shall compute a photometric redshift for all detected Objects.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0040]{DMS-REQ-0040}:
Enable BAO Analysis \newline

\paragraph{Object Characterization}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0276}
\textbf{ID:} DMS-REQ-0276 (Priority: 1b)

\textbf{Specification:} Each entry in the Object Catalog shall include the following characterization measures: a point-source model fit, a bulge-disk model fit, standard colors, a centroid, adaptive moments, Petrosian and Kron fluxes, surface brightness at multiple apertures, proper motion and parallax, and a variability characterization.

\textbf{Discussion: }These measurements are intended to enable LSST "static sky" science.

\emph{Derived from Requirements:}

OSS-REQ-0137:
Catalogs (Level 2) \newline

\subsubsection{Associate Sources to Objects}

\label{DMS-REQ-0034}
\textbf{ID:} DMS-REQ-0034 (Priority: 1a)

\textbf{Specification:} The DMS shall associate Sources measured at different times and in different passbands with entries in the Object catalog.

\textbf{Discussion:} The task of association is to relate Sources from different times, filters, and sky positions, to the corresponding Objects. Having made these associations, further measurements can be made on the full object data to generate astronomically useful quantities.

\emph{Derived from Requirements:}

OSS-REQ-0339:
Level 2 Source-Object Association Quality \newline
\hyperref[DMS-REQ-0081]{DMS-REQ-0081}:
Produce Object Catalog \newline

\subsubsection{Deep Detection Coadds}

\label{DMS-REQ-0279}
\textbf{ID:} DMS-REQ-0279 (Priority: 1b)

\textbf{Specification:} The DMS shall periodicaly create Co-added Images in each of the \textit{u,g,r,i,z,y} passbands by combining all archived exposures taken of the same region of sky and in the same passband that meet specified quality conditions.

\textbf{Discussion: }Quality attributes may include thresholds on seeing, sky brightness, wavefront quality, PSF shape and spatial variability, or date of exposure.

\emph{Derived from Requirements:}

OSS-REQ-0136:
Co-added Exposures \newline

\subsubsection{Template Coadds}

\label{DMS-REQ-0280}
\textbf{ID:} DMS-REQ-0280 (Priority: 1b)

\textbf{Specification:} The DMS shall periodically create Template Images in each of the \textit{u,g,r,i,z,y} passbands that are constructed identically to Deep Detection Coadds, but where the contributing Calibrated Exposures are limited to a range of observing epochs \textbf{templateMaxTimespan}, the images are partitioned by airmass into multiple bins, and where the quality criteria may be different.

\textbf{Discussion: }Image Templates are used by the Image Difference pipeline in the course of identifying transient or variable sources. The range of epochs must be limited to avoid confusing slowly moving sources (such as high proper motion stars) with genuine transients. It is anticipated that separate templates will be created in each passband for 3 separate ranges of airmass.

\begin{parameters}
Maximum range in observed epoch over which input Exposures may contribute to a template image.
&
1
&
\unitname{%
year
}
&
\paramname{%
templateMaxTimespan
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0136:
Co-added Exposures \newline

\subsubsection{Multi-band Coadds}

\label{DMS-REQ-0281}
\textbf{ID:} DMS-REQ-0281 (Priority: 1b)

\textbf{Specification:} The DMS shall periodically create Multi-band Coadd images which are constructed similarly to Deep Detection Coadds, but where all passbands are combined.

\textbf{Discussion: }The multi-color Coadds are intended for very deep detection.

\emph{Derived from Requirements:}

OSS-REQ-0136:
Co-added Exposures \newline

\subsubsection{Best Seeing Coadds}

\label{DMS-REQ-0330}
\textbf{ID:} DMS-REQ-0330 (Priority: 2)

\textbf{Specification:} Best seeing coadds shall be made for each band (including multi-color).

\textbf{Discussion:} \hyperref[DMS-REQ-0279]{DMS-REQ-0279} states that seeing-based co-adds should be possible. This requirement states that they shall be made.

\emph{Derived from Requirements:}

OSS-REQ-0136:
Co-added Exposures \newline

\subsubsection{PSF-Matched Coadds}

\label{DMS-REQ-0335}
\textbf{ID:} DMS-REQ-0335 (Priority: 1b)

\textbf{Specification:} One (ugrizy plus multi-band) set of PSF-matched coadds shall be made but shall not be archived.

\textbf{Discussion:} These are used to measure colors and shapes of objects at "standard" seeing. Sufficient provenance information will be made available to allow these coadds to be recreated by Level 3 users.

\subsubsection{Detecting faint variable objects}

\label{DMS-REQ-0337}
\textbf{ID:} DMS-REQ-0337 (Priority: 2)

\textbf{Specification: }The DMS shall be able to detect faint objects showing long-term variability, or nearby object with high proper motions.

\textbf{Discussion:} For example, this could be implemented using short-period (yearly) coadds.

\emph{Derived from Requirements:}

OSS-REQ-0136:
Co-added Exposures \newline

\subsubsection{Targeted Coadds}

\label{DMS-REQ-0338}
\textbf{ID:} DMS-REQ-0338 (Priority: 2)

\textbf{Specification:} It shall be possible to retain small sections of all generated coadds.

\textbf{Discussion:} This supports quality assessment and targeted science.

\emph{Derived from Requirements:}

OSS-REQ-0136:
Co-added Exposures \newline
LSR-REQ-0040:
Data Quality Monitoring \newline

\subsubsection{Coadd Image Method Constraints}

\label{DMS-REQ-0278}
\textbf{ID:} DMS-REQ-0278 (Priority: 1b)

\textbf{Specification:} Coadd Images shall be created by combining spatially overlapping Processed Visit Images (on which bad pixels and transient sources have been masked), where the contributing Processed Visit Images have been re-projected to a common reference geometry, and matched to a common background level which best approximates the astrophysical background.

\textbf{Discussion:} It is expected that coadded images will be produced for all observed regions of the sky, not just the main survey area.

\emph{Derived from Requirements:}

OSS-REQ-0136:
Co-added Exposures \newline

\subsubsection{Provide PSF for Coadded Images}

\label{DMS-REQ-0047}
\textbf{ID:} DMS-REQ-0047 (Priority: 1b)

\textbf{Specification:} The DMS shall determine a characterization of the PSF for any specified location in coadded images.

\textbf{Discussion:} The PSF model will be primarily used to perform initial object characterization and bootstrapping of multi-epoch object characterization (e.g., Multifit).

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0041]{DMS-REQ-0041}:
Measure Intrinsic Ellipticities of Small Galaxies \newline
OSS-REQ-0153:
World Coordinate System Accuracy \newline
OSS-REQ-0316:
Wavefront Sensor Data \newline
OSS-REQ-0136:
Co-added Exposures \newline

\subsubsection{Coadded Image Provenance}

\label{DMS-REQ-0106}
\textbf{ID:} DMS-REQ-0106 (Priority: 1b)

\textbf{Specification:} For each Coadded Image, DMS shall store: the list of input images and the pipeline parameters, including software versions, used to derive it, and a sufficient set of metadata attributes for users to re-create them in whole or in part.

\textbf{Discussion:} Not all coadded image types will be made available to end-users or retained for the life of the survey; however, sufficient metadata will be preserved so that they may be recreated by end-users.

\emph{Derived from Requirements:}

OSS-REQ-0122:
Provenance \newline
\hyperref[DMS-REQ-0104]{DMS-REQ-0104}:
Produce Co-Added Exposures \newline

\subsubsection{Coadd Source Catalog}

\label{DMS-REQ-0277}
\textbf{ID:} DMS-REQ-0277 (Priority: 1b)

\textbf{Specification:} The DMS shall, in the course of creating the master Source Catalog, create a catalog from the coadds of all sources detected in each passband with a SNR > \textbf{coaddDetectThresh}.

\textbf{Discussion: }CoaddSources are in general composites of overlapping astrophysical objects. This catalog is an intermediate product in DR production, and will not be permanently archived nor released to end-users.

\begin{parameters}
S/N threshold for detecting sources in Co-Add images for building the Source Catalog.
&
5
&
\unitname{%
float
}
&
\paramname{%
coaddDetectThresh
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0267]{DMS-REQ-0267}:
Source Catalog \newline
OSS-REQ-0137:
Catalogs (Level 2) \newline

\paragraph{Detecting extended  low surface brightness objects}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0349}
\textbf{ID:} DMS-REQ-0349 (Priority: 2)

\textbf{Specification: }It shall be possible to detect extended low surface brightness objects in coadds.

\textbf{Discussion: }For example, this could be done by using the binned detection algorithm from SDSS.

\subsubsection{Forced-Source Catalog}

\label{DMS-REQ-0268}
\textbf{ID:} DMS-REQ-0268 (Priority: 1b)

\textbf{Specification:} The DMS shall create a Forced-Source Catalog, consisting of measured fluxes for all entries in the Object Catalog on all Processed Visit Images and Difference Images. Measurements for each forced-source shall include the object and visit IDs, the modelled flux and error (given fixed position, shape, and deblending parameters), and measurement quality flags.

\textbf{Discussion: }The large number of Forced Sources makes it impractical to measure more attributes than are necessary to construct a light curve for variability studies.

\emph{Derived from Requirements:}

OSS-REQ-0137:
Catalogs (Level 2) \newline

\subsubsection{Tracking Characterization Changes Between Data Releases}

\label{DMS-REQ-0339}
\textbf{ID:} DMS-REQ-0339 (Priority: 1a)

\textbf{Specification:} Small, overlapping, samples of data from older releases shall be kept loaded in the database.

\textbf{Discussion: }This enables a comparison of how current data releases relate to previous data releases and to improve data quality monitoring.

\emph{Derived from Requirements:}

LSR-REQ-0040:
Data Quality Monitoring \newline

\subsubsection{Produce Images for EPO}

\label{DMS-REQ-0103}
\textbf{ID:} DMS-REQ-0103 (Priority: 1b)

\textbf{Specification:} The DMS shall produce images for EPO purposes, according to the requirements in the DM-EPO ICD.

    \textbf{Discussion: }This is expected to include polychromatic (e.g., RGB JPEG) images for casual users. The DM-EPO ICD is \citeds{LSE-131}.

\emph{Derived from Requirements:}

OSS-REQ-0136:
Co-added Exposures \newline

\subsubsection{All-Sky Visualization of Data Releases}

\label{DMS-REQ-0329}
\textbf{ID:} DMS-REQ-0329 (Priority: 2)

\textbf{Specification:} Data Release Processing shall generate co-adds suitable for use in all-sky visualization tools, allowing panning and zooming of the entire data release.

\textbf{Discussion:} For example, this could mean HEALPix tiles suitable for use in a HiPS server. The exact technology choice has to be confirmed before understanding which format is required.

\emph{Derived from Requirements:}

OSS-REQ-0136:
Co-added Exposures \newline

\subsection{Calibration Data Products}

\subsubsection{Calibration Data Products}

\label{DMS-REQ-0130}
\textbf{ID:} DMS-REQ-0130 (Priority: 1a)

\textbf{Specification:} The DMS shall produce and archive Calibration Data Products that capture the signature of the telescope, camera and detector, including at least: Crosstalk correction matrix, Bias and Dark correction frames, a set of monochromatic dome flats spanning the wavelength range, a synthetic broad-band flat per filter, and an illumination correction frame per filter.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0076]{DMS-REQ-0076}:
Keep Science Data Archive \newline
OSS-REQ-0129:
Exposures (Level 1) \newline
OSS-REQ-0194:
Calibration Exposures Per Day \newline
OSS-REQ-0271:
Supported Image Types \newline

\subsubsection{Calibration Image Provenance}

\label{DMS-REQ-0132}
\textbf{ID:} DMS-REQ-0132 (Priority: 1a)

\textbf{Specification:} For each Calibration Production data product, DMS shall record: the list of input exposures and the range of dates over which they were obtained; the processing parameters; the calibration products used to derive it; and a set of metadata attributes including at least: the date of creation; the calibration image type (e.g. dome flat, superflat, bias, etc); the provenance of the processing software; and the instrument configuration including the filter in use, if applicable.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0130]{DMS-REQ-0130}:
Calibration Data Products \newline
OSS-REQ-0122:
Provenance \newline
OSS-REQ-0123:
Reproducibility \newline

\subsubsection{Bad Pixel Map}

\label{DMS-REQ-0059}
\textbf{ID:} DMS-REQ-0059 (Priority: 1a)

\textbf{Specification: }The DMS shall produce on an as-needed basis a map of detector pixels that are affected by one or more pathologies, such as non-responsive pixels, charge traps, and hot pixels. The particular pathologies shall be bit-encoded in, at least, 32-bit pixel values, so that additional pathologies may also be recorded in down-stream processing software.

\textbf{Discussion:} The fraction of bad pixels is expected to be small. Therefore the Reference Map, while logically equivalent to an image, may be stored in a more compressible form.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0058]{DMS-REQ-0058}:
Correct for Instrument Sensitivity Variation \newline
OSS-REQ-0129:
Exposures (Level 1) \newline
OSS-REQ-0271:
Supported Image Types \newline

\subsubsection{Bias Residual Image}

\label{DMS-REQ-0060}
\textbf{ID:} DMS-REQ-0060 (Priority: 1a)

\textbf{Specification:} The DMS shall construct on an as-needed basis an image that corrects for any temporally stable bias structure that remains after overscan correction. The Bias Residual shall be constructed from multiple, zero-second exposures where the overscan correction has been applied.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0055]{DMS-REQ-0055}:
Correct for Camera Bias Structure \newline
OSS-REQ-0271:
Supported Image Types \newline
OSS-REQ-0046:
Calibration \newline

\subsubsection{Crosstalk Correction Matrix}

\label{DMS-REQ-0061}
\textbf{ID:} DMS-REQ-0061 (Priority: 1a)

\textbf{Specification:} The DMS shall, on an as-needed basis, determine from appropriate calibration data what fraction of the signal detected in any given amplifier on each sensor in the focal plane appears in any other amplifier, and shall record that fraction in a correction matrix. The applicability of the correction matrix shall be verified in production processing on science data.

\textbf{Discussion: }The frequency with which the Cross-talk Correction Matrix must be computed will be determined during Commissioning and monitored during operations.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0056]{DMS-REQ-0056}:
Correct for Camera Crosstalk \newline
OSS-REQ-0349:
Data Release Production Crosstalk Correction \newline

\subsubsection{Dark Current Correction Frame}

\label{DMS-REQ-0282}
\textbf{ID:} DMS-REQ-0282 (Priority: 1a)

\textbf{Specification:} The DMS shall produce on an as-needed basis a dark current correction image, which is constructed from multiple, closed-shutter exposures of appropriate duration. The effectiveness of the Dark Correction shall be verified in production processing on science data.

\textbf{Discussion: }The need for a dark current correction will have to be quantified during Commissioning. Collecting closed-dome dark exposures may be deemed necessary to monitor the health of the detectors, even if not used in calibration processing.

\emph{Derived from Requirements:}

OSS-REQ-0271:
Supported Image Types \newline
OSS-REQ-0046:
Calibration \newline

\subsubsection{Monochromatic Flatfield Data Cube}

\label{DMS-REQ-0063}
\textbf{ID:} DMS-REQ-0063 (Priority: 1b)

\textbf{Specification:} The DMS shall produce on an as-needed basis an image that corrects for the color-dependent, pixel-to-pixel non-uniformity in the detector response. The images in the cube shall be constructed from exposures at multiple wavelengths of a uniformly illuminated source. The effectiveness of the flat-field shall be verified in production processing on science data.

\textbf{Discussion:} Monochromatic flat-fields are expected to be produced no more frequently than monthly, owing to the time required to obtain the exposures.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0058]{DMS-REQ-0058}:
Correct for Instrument Sensitivity Variation \newline
\hyperref[DMS-REQ-0057]{DMS-REQ-0057}:
Correct for Detector Fringing \newline
OSS-REQ-0271:
Supported Image Types \newline
OSS-REQ-0046:
Calibration \newline

\subsubsection{Illumination Correction Frame}

\label{DMS-REQ-0062}
\textbf{ID:} DMS-REQ-0062 (Priority: 1b)

\textbf{Specification:} The DMS shall produce on an as-needed basis an image that corrects for the non-uniform illumination of the flat-field calibration apparatus on the focal plane. The effectiveness of the Illumination Correction shall be verified in production processing on science data.

\textbf{Discussion:} The Illumination correction is anticipated to be quite stable. Updates to the correction should be no more frequent than monthly.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0058]{DMS-REQ-0058}:
Correct for Instrument Sensitivity Variation \newline
OSS-REQ-0271:
Supported Image Types \newline
OSS-REQ-0046:
Calibration \newline

\subsubsection{Fringe Correction Frame}

\label{DMS-REQ-0283}
\textbf{ID:} DMS-REQ-0283 (Priority: 1b)

\textbf{Specification:} The DMS shall produce on an as-needed basis an image that corrects for detector fringing. The effectiveness of the Fringe Correction shall be verified in production processing on science data.

\textbf{Discussion: }Fringing is likely to affect only the reddest filters, where the CCD substrate becomes semi-transparent to incident light.

\emph{Derived from Requirements:}

OSS-REQ-0271:
Supported Image Types \newline
OSS-REQ-0046:
Calibration \newline

\subsection{Special Programs}

\subsubsection{Processing of Data From Special Programs}

\label{DMS-REQ-0320}
\textbf{ID:} DMS-REQ-0320 (Priority: 2)

\textbf{Specification:} It shall be possible for special programs to trigger their own data processing recipes.

\textbf{Discussion:} This affects both L1 and L2 data products. For some special programs there may be minimalist L1 processing, for other special programs the L1 processing may be the standard alert generation processing. The scope of special programs processing is currently undefined.

\emph{Derived from Requirements:}

LSR-REQ-0075:
Survey Time Allocation \newline

\subsubsection{Level 1 Processing of Special Programs Data}

\label{DMS-REQ-0321}
\textbf{ID:} DMS-REQ-0321 (Priority: 2)

\textbf{Specification:} All Level 1 processing from special programs shall be completed before data arrives from the following night's observations.

\subsubsection{Constraints on Level 1 Special Program Products Generation}

\label{DMS-REQ-0344}
\textbf{ID:} DMS-REQ-0344 (Priority: 2)

\textbf{Specification: }The publishing of Level 1 data products from Special Programs shall be subject to the same performance requirements of the standard Level 1 system. In particular \textbf{L1PublicT} and \textbf{OTT1}.

\begin{parameters}
Maximum time from the acquisition of science data to the public release of associated Level 1 Data Products (except alerts)
&
24
&
\unitname{%
hour
}
&
\paramname{%
L1PublicT
} \\\hline
The latency of reporting optical transients following the completion of readout of the last image of a visit
&
1
&
\unitname{%
minute
}
&
\paramname{%
OTT1
} \\\hline
\end{parameters}

\subsubsection{Special Programs Database}

\label{DMS-REQ-0322}
\textbf{ID:} DMS-REQ-0322 (Priority: 1b)

\textbf{Specification:} Data products for special programs shall be stored in databases that are distinct from those used to store standard Level 1 and Level 2 data products. It shall be possible for these databases to be federated with the Level 1 and Level 2 databases to allow cross-queries and joins.

\section{Productions}

\subsection{Query Repeatability}

\label{DMS-REQ-0291}
\textbf{ID:} DMS-REQ-0291 (Priority: 1b)

\textbf{Specification:} The DMS shall ensure that any query executed at a particular point in time against any DMS delivered database shall be repeatable at a later date, and produce results that are either identical or include additional results (owing to updates from Level-1 processing).

\textbf{Discussion:} It would be desirable to have the ability to "save" a query such that the date or data release would be included explicitly. Additionally, the ability to associate this query with a DOI would allow queries to be shared and included in scientific papers without requiring a large copy and paste.

\emph{Derived from Requirements:}

OSS-REQ-0181:
Data Products Query and Download Infrastructure \newline

\subsection{Uniqueness of IDs Across Data Releases}

\label{DMS-REQ-0292}
\textbf{ID:} DMS-REQ-0292 (Priority: 1a)

\textbf{Specification:} To reduce the likelihood for confusion, all IDs shall be unique across databases and database versions, other than those corresponding to uniquely identifiable entities (i.e., IDs of exposures).

\textbf{Discusion:} For example, DR4 and DR5 (or any other) release will share no identical Object, Source, DIAObject or DIASource IDs.

\emph{Derived from Requirements:}

OSS-REQ-0137:
Catalogs (Level 2) \newline
OSS-REQ-0130:
Catalogs (Level 1) \newline

\subsection{Selection of Datasets}

\label{DMS-REQ-0293}
\textbf{ID:} DMS-REQ-0293 (Priority: 1a)

\textbf{Specification:} A Dataset may consist of one or more pixel images, a set of records in a file or database, or any other grouping of data that are processed or produced as a logical unit. The DMS shall be able to identify and retrieve complete, consistent datasets for processing.

\textbf{Discussion: }Logical groupings might be pairs of Exposures in a Visit, along with supporting metadata and provenance information, or might be groupings defined in the context of Level-3 processing.

\emph{Derived from Requirements:}

OSS-REQ-0118:
Consistency and Completeness \newline
OSS-REQ-0176:
Data Access \newline

\subsection{Processing of Datasets}

\label{DMS-REQ-0294}
\textbf{ID:} DMS-REQ-0294 (Priority: 1b)

\textbf{Specification:} The DMS shall process all requested datasets until either a successful result is recorded or a permanent failure is recognized. If any dataset is processed, in part or in whole, more than once, only one of the wholly processed results will be recorded for further processing.

\textbf{Discussion: }The criteria may be specified by DMS processing software, or by a scientist end-user for Level-3 production.

\emph{Derived from Requirements:}

OSS-REQ-0117:
Automated Production \newline
OSS-REQ-0118:
Consistency and Completeness \newline
OSS-REQ-0119:
Completeness \newline
OSS-REQ-0120:
Consistency \newline

\subsection{Transparent Data Access}

\label{DMS-REQ-0295}
\textbf{ID:} DMS-REQ-0295 (Priority: 2)

\textbf{Specification:} The DMS shall provide an interface that allows retrieval by productions or science users of datasets from any Facility where they may reside without requiring reconfiguration.

\emph{Derived from Requirements:}

OSS-REQ-0176:
Data Access \newline

\subsection{Alert Production}

\subsubsection{Level-1 Production Completeness}

\label{DMS-REQ-0284}
\textbf{ID:} DMS-REQ-0284 (Priority: 1b)

\textbf{Specification:} The DMS shall ensure that all images taken by the camera and marked for Level-1 processing are eventually retrieved, archived, and processed even in the event of connectivity failure between downstream Facilities.

\emph{Derived from Requirements:}

OSS-REQ-0052:
Summit Data Buffer \newline

\subsubsection{Calibration Images Available Within Specified Time}

\label{DMS-REQ-0131}
\textbf{ID:} DMS-REQ-0131 (Priority: 2)

\textbf{Specification:} Calibration products from a group of up to \textbf{nCalExpProc} related exposures that should be processed together, shall be available from the DMS image archive within \textbf{calProcTime} of the end of the acquisition of images/data for that group.

\textbf{Discussion: }The motivation here is that calibration images will be needed at least 1 hour prior to the start of observing and this requirement allows the calibration observations to be planned accordingly.

\begin{parameters}
Time allowed to process \textbf{nCalExpProc} calibration exposures and have them available within the DMS.
&
1200
&
\unitname{%
second
}
&
\paramname{%
calProcTime
} \\\hline

Maximum number of calibration exposures that can be processed together within time \textbf{calProcTime}.

&
25
&
\unitname{%
integer
}
&
\paramname{%
nCalExpProc
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0130]{DMS-REQ-0130}:
Calibration Data Products \newline
OSS-REQ-0021:
Base Site \newline
OSS-REQ-0046:
Calibration \newline
OSS-REQ-0194:
Calibration Exposures Per Day \newline

\subsubsection{Transient Alert Distribution}

\label{DMS-REQ-0002}
\textbf{ID:} DMS-REQ-0002 (Priority: 1b)

\textbf{Specification:} Identified transient events shall be made available to end-users in the form of alerts, which shall be published to community alert distribution networks using community-standard protocols, to be determined during the LSST construction phase as community standards evolve.

\emph{Derived from Requirements:}

OSS-REQ-0127:
Level 1 Data Product Availability \newline
OSS-REQ-0184:
Transient Alert Publication \newline

\subsubsection{Alert Filtering Service}

\label{DMS-REQ-0342}
\textbf{ID:} DMS-REQ-0342 (Priority: 2)

\textbf{Specification:} A basic, limited capacity, alert filtering service shall be provided that can be given user defined filters to reduce the alert stream to manageable levels.

\emph{Derived from Requirements:}

LSR-REQ-0025:
Transient Filtering \newline

\paragraph{Pre-defined alert filters}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0348}
\textbf{ID:} DMS-REQ-0348 (Priority: 2)

\textbf{Specification: }Users of the LSST Alert Filtering Service shall be able to use a predefined set of simple filters.

\textbf{Discussion:} See LSR-REQ-0026

\emph{Derived from Requirements:}

LSR-REQ-0026:
Predefined Transient Filters \newline

\paragraph{Performance Requirements for LSST Alert Filtering Service}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0343}
\textbf{ID:} DMS-REQ-0343 (Priority: 2)

\textbf{Specification:} The LSST alert filtering service shall support \textbf{numBrokerUsers} simultaneous users with each user allocated a bandwidth capable of receiving the equivalent of \textbf{numBrokerAlerts} alerts per visit.

\textbf{Discussion:} The constraint on number of alerts is specified for the full VOEvent alert content, but could also be satisfied by all alerts being received with minimal alert content.

\begin{parameters}
 Number of full-sized alerts that can be received per visit per user.
&
20
&
\unitname{%
integer
}
&
\paramname{%
numBrokerAlerts
} \\\hline
Supported number of simultaneous users connected to the LSST alert filtering system.
&
100
&
\unitname{%
integer
}
&
\paramname{%
numBrokerUsers
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0184:
Transient Alert Publication \newline

\subsubsection{Level 1 Source Association}

\label{DMS-REQ-0285}
\textbf{ID:} DMS-REQ-0285 (Priority: 1b)

\textbf{Specification:} The DMS shall associate clusters of DIASources detected on multiple visits taken at different times with either a DIAObject or an SSObject.

\textbf{Discussion: }The association will represent the underlying astrophysical phenomenon.

\emph{Derived from Requirements:}

OSS-REQ-0159:
Level 1 Moving Object Quality \newline
OSS-REQ-0160:
Level 1 Difference Source - Difference Object Association Quality \newline
OSS-REQ-0130:
Catalogs (Level 1) \newline

\subsubsection{SSObject Precovery}

\label{DMS-REQ-0286}
\textbf{ID:} DMS-REQ-0286 (Priority: 2)

\textbf{Specification:} Upon identifying a new SSObject, the DMS shall associate additional DIAObjects that are consistent with the orbital parameters (precovery), and update DIAObject entries so associated.

\emph{Derived from Requirements:}

OSS-REQ-0159:
Level 1 Moving Object Quality \newline

\subsubsection{DIASource Precovery}

\label{DMS-REQ-0287}
\textbf{ID:} DMS-REQ-0287 (Priority: 1b)

\textbf{Specification:} For all DIASources not associated with either DIAObjects or SSObjects, the DMS shall perform forced photometry at the location of the new source (precovery) on all Difference Exposures obtained in the prior \textbf{precoveryWindow}, and make the results publicly available within \textbf{L1PublicT}.

\textbf{Discussion: }The \textbf{precoveryWindow }is intended to satisfy the most common scientific use cases (e.g., Supernovae), without placing an undue burden on the processing infrastructure.  For reasons of practicality and efficiency, \textbf{precoveryWindow }<= l\textbf{1CacheLifetime}.

\begin{parameters}
Maximum look-back time for precovery measurments on prior Exposures.
&
30
&
\unitname{%
day
}
&
\paramname{%
precoveryWindow
} \\\hline
Maximum time from the acquisition of science data to the public release of associated Level 1 Data Products (except alerts)
&
24
&
\unitname{%
hour
}
&
\paramname{%
L1PublicT
} \\\hline
Lifetime in the cache of un-archived Level-1 data products.
&
30
&
\unitname{%
day
}
&
\paramname{%
l1CacheLifetime
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0130:
Catalogs (Level 1) \newline

\subsubsection{Use of External Orbit Catalogs}

\label{DMS-REQ-0288}
\textbf{ID:} DMS-REQ-0288 (Priority: 2)

\textbf{Specification:} It shall be possible for DMS to make use of approved external catalogs and observations to improve the identification of SSObjects, and therefore increase the purity of the transient Alert stream in nightly processing.

\emph{Derived from Requirements:}

OSS-REQ-0159:
Level 1 Moving Object Quality \newline

\subsubsection{Solar System Objects Available Within Specified Time}

\label{DMS-REQ-0089}
\textbf{ID:} DMS-REQ-0089 (Priority: 1b)

\textbf{Specification:} Detected moving objects and associated metadata shall be available for public access in the DMS science data archive within time \textbf{L1PublicT }of their generation by the DMS.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0004]{DMS-REQ-0004}:
Nightly Data Accessible Within 24 hrs \newline
\hyperref[DMS-REQ-0086]{DMS-REQ-0086}:
Produce Orbit Catalog \newline
OSS-REQ-0127:
Level 1 Data Product Availability \newline

\subsubsection{Generate Data Quality Report Within Specified Time}

\label{DMS-REQ-0096}
\textbf{ID:} DMS-REQ-0096 (Priority: 1a)

\textbf{Specification:} The DMS shall generate a nightly Data Quality Report within time \textbf{dqReportComplTime }in both human-readable and machine-readable forms.

\textbf{Discussion:} The Report must be timely in order to evaluate whether changes to hardware, software, or procedures are needed for the following night's observing.

\begin{parameters}
Latency for producing Level 1 Data Quality Report.
&
4
&
\unitname{%
hour
}
&
\paramname{%
dqReportComplTime
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0131:
Nightly Summary Products \newline

\subsubsection{Generate DMS Performance Report Within Specified Time}

\label{DMS-REQ-0098}
\textbf{ID:} DMS-REQ-0098 (Priority: 1b)

\textbf{Specification:} The DMS shall generate a nightly DMS Performance Report within time \textbf{perfReportComplTime }in both human-readable and machine-readable forms.

\textbf{Discussion:} The Report must be timely in order to evaluate whether changes to hardware, software, or procedures are needed for the following night's observing.

\begin{parameters}
Latency for producing Level 1 DMS Performance Report.
&
4
&
\unitname{%
hour
}
&
\paramname{%
perfReportComplTime
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0131:
Nightly Summary Products \newline

\subsubsection{Generate Calibration Report Within Specified Time}

\label{DMS-REQ-0100}
\textbf{ID:} DMS-REQ-0100 (Priority: 1b)

\textbf{Specification:} The DMS shall generate a nightly Calibration Report within time \textbf{calibReportComplTime }in both human-readable and machine-readable forms.

\textbf{Discussion:} The Report must be timely in order to evaluate whether changes to hardware, software, or procedures are needed for the following night's observing.

\begin{parameters}
Latency for producing Level 1 Calibration Report.
&
4
&
\unitname{%
hour
}
&
\paramname{%
calibReportComplTime
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0131:
Nightly Summary Products \newline

\subsection{Calibration Production}

\subsubsection{Calibration Production Processing}

\label{DMS-REQ-0289}
\textbf{ID:} DMS-REQ-0289 (Priority: 1a)

\textbf{Specification:} The DMS shall be capable of producing calibration data products on an as-needed basis, consistent with monitoring the health and performance of the instrument, the availability of raw calibration exposures, the temporal stability of the calibrations, and of the SRD requirements for calibration accuracy.

\emph{Derived from Requirements:}

OSS-REQ-0170:
Calibration Data \newline
OSS-REQ-0004:
The Archive Facility \newline

\subsection{Data Release Production}

\subsubsection{Associating Objects across data releases}

\label{DMS-REQ-0350}
\textbf{ID:} DMS-REQ-0350 (Priority: 2)

\textbf{Specification:} It shall be possible to associate an Object in one data release to the most likely match in the Object table from another data release. This shall be possible without the previous data releases being online.

\textbf{Discussion:} This could be done with a database table mapping every Object in one data release to the matched Object in every other data release.

\subsection{Level 3 Production}

\subsubsection{Access Controls of Level 3 Data Products}

\label{DMS-REQ-0340}
\textbf{ID:} DMS-REQ-0340 (Priority: 2)

\textbf{Specification:} All Level 3 data products shall be configured to have the ability to have access restricted to the owner, a list of people, a named group, or be completely public.

\textbf{Discussion:} These features are supported by VOSpace.

\emph{Derived from Requirements:}

OSS-REQ-0142:
Access \newline
OSS-REQ-0176:
Data Access \newline
OSS-REQ-0187:
Information Security \newline

\subsubsection{Level 3 Data Import}

\label{DMS-REQ-0290}
\textbf{ID:} DMS-REQ-0290 (Priority: 2)

\textbf{Specification:} The DMS shall be able to ingest tables from common file formats (e.g. FITS tables, CSV files with supporting metadata) to facilitate the loading of external catalogs and the production of Level-3 data products.

\emph{Derived from Requirements:}

OSS-REQ-0140:
Production \newline

\subsubsection{DAC resource allocation for Level 3 processing}

\label{DMS-REQ-0119}
\textbf{ID:} DMS-REQ-0119 (Priority: 2)

\textbf{Specification:} The DMS shall provide a resource allocation mechanism for the DACs that allows the prioritization and allocation of resources to a variety of Level 3 processing activities.

\textbf{Discussion:} It is assumed that the DAC Level 3 processing resources will likely be oversubscribed, making this necessary.

\emph{Derived from Requirements:}

OSS-REQ-0143:
Resource Allocation \newline

\subsubsection{Level 3 Data Product Self Consistency}

\label{DMS-REQ-0120}
\textbf{ID:} DMS-REQ-0120 (Priority: 2)

\textbf{Specification:} The DMS shall provide a means for ensuring that users' Level 3 processing tasks can be carried out on self-consistent inputs - i.e., catalogs, images, metadata, calibrations, camera configuration data, etc., that match each other and all arise from consistent Level 1 and Level 2 processings.

\emph{Derived from Requirements:}

OSS-REQ-0120:
Consistency \newline
OSS-REQ-0118:
Consistency and Completeness \newline

\subsubsection{Provenance for Level 3 processing at DACs}

\label{DMS-REQ-0121}
\textbf{ID:} DMS-REQ-0121 (Priority: 2)

\textbf{Specification:} The DMS shall provide a means for recording provenance information for Level 3 processing that is performed at DACs, covering at least all the DMS-provided inputs to the processing (e.g., catalog data used as inputs, dataset metadata, calibrations and camera data from the EFD).

\textbf{Discussion:} The DMS should also provide an optional means for Level 3 processing users at DACs to maintain basic provenance information on their own inputs to a processing task, such as code or additional calibration data.

\textbf{Rationale:} the DMS should facilitate Level 3 processing users in being able to carry out their work in a reproducible way.

\emph{Derived from Requirements:}

OSS-REQ-0122:
Provenance \newline

\subsubsection{Software framework for Level 3 catalog processing}

\label{DMS-REQ-0125}
\textbf{ID:} DMS-REQ-0125 (Priority: 2)

\textbf{Specification:} The DMS shall provide a software framework that facilitates Level 3 processing of catalogs.  This framework shall provide a means for applying user-provided processing to catalog data, including measuring and ensuring the completeness of the application - i.e., that the specified processing was applied to all of, and only, the entire contents of the desired catalog(s).

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0120]{DMS-REQ-0120}:
Level 3 Data Product Self Consistency \newline
OSS-REQ-0121:
Open Source, Open Configuration \newline
OSS-REQ-0122:
Provenance \newline

\subsubsection{Software framework for Level 3 image processing}

\label{DMS-REQ-0128}
\textbf{ID:} DMS-REQ-0128 (Priority: 2)

\textbf{Specification:} The DMS shall provide a software framework that facilitates Level 3 processing of image data.  This framework shall provide a means for applying user-provided processing to image data, including measuring and ensuring the completeness of the application - i.e., that the specified processing was applied to all of, and only, the entire contents of the desired dataset.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0120]{DMS-REQ-0120}:
Level 3 Data Product Self Consistency \newline
OSS-REQ-0121:
Open Source, Open Configuration \newline
OSS-REQ-0122:
Provenance \newline

\section{Software}

\subsection{Software Architecture to Enable Community Re-Use}

\label{DMS-REQ-0308}
\textbf{ID:} DMS-REQ-0308 (Priority: 1b)

\textbf{Specification:} The DMS software architecture shall be designed to enable high throughput on high-performance compute platforms, while also enabling the use of science-specific algorithms by science users on commodity desktop compute platforms.

\textbf{Discussion: }The high data volume and short processing timeline for LSST Productions anticipates the use of high-performance compute infrastructure, while the need to make the science algorithms immediately applicable to science teams for Level-3 processing drives the need for easy interoperability with desktop compute environments.

\emph{Derived from Requirements:}

OSS-REQ-0121:
Open Source, Open Configuration \newline

\subsection{Applications Software}

\subsubsection{Simulated Data}

\label{DMS-REQ-0009}
\textbf{ID:} DMS-REQ-0009 (Priority: 1b)

\textbf{Specification:} The DMS shall provide the ability to inject artificial or simulated data into data products to assess the functional and temporal performance of the production processing software.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0007]{DMS-REQ-0007}:
Pipeline Infrastructure \newline
OSS-REQ-0351:
Difference Source Spurious Probability Metric \newline
OSS-REQ-0353:
Difference Source Spuriousness Threshold - Transients \newline
OSS-REQ-0354:
Difference Source Spuriousness Threshold - MOPS \newline

\subsubsection{Pre-cursor, and Real Data}

\label{DMS-REQ-0296}
\textbf{ID:} DMS-REQ-0296 (Priority: 1a)

\textbf{Specification:} The DMS shall provide for the ability to process data from other electronic, pixel-oriented astronomical imaging cameras.

\textbf{Discussion: }A comparison of DMS products to that produced by similar systems for other cameras provides an essential validation of DMS algorithms and techniques.

\subsubsection{Image Differencing}

\label{DMS-REQ-0032}
\textbf{ID:} DMS-REQ-0032 (Priority: 1b)

\textbf{Specification:} The DMS shall provide software to perform image differencing, generating Difference Exposures from the comparison of single exposures and/or coadded images.

\emph{Derived from Requirements:}

OSS-REQ-0121:
Open Source, Open Configuration \newline
OSS-REQ-0129:
Exposures (Level 1) \newline

\subsubsection{Provide Source Detection Software}

\label{DMS-REQ-0033}
\textbf{ID:} DMS-REQ-0033 (Priority: 1a)

\textbf{Specification:} The DMS shall provide software for the detection of sources in a calibrated image, which may be a Difference Image or a Co-Add image.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0080]{DMS-REQ-0080}:
Difference Sources Available within 24 hours \newline
OSS-REQ-0121:
Open Source, Open Configuration \newline
OSS-REQ-0130:
Catalogs (Level 1) \newline
OSS-REQ-0137:
Catalogs (Level 2) \newline

\subsubsection{Provide Calibrated Photometry}

\label{DMS-REQ-0043}
\textbf{ID:} DMS-REQ-0043 (Priority: 1a)

\textbf{Specification:} The DMS shall provide calibrated photometry in each observed passband for all measured entities (e.g., DIASources, Sources, Objects), measuring the AB magnitude of the equivalent flat-SED source, above the atmosphere. Fluxes, possibly in jansky, shall be calculated for all measured entities.

\textbf{Discussion: }Note that the SED is only assumed to be flat within the passband of the measurement.

\emph{Derived from Requirements:}

OSS-REQ-0137:
Catalogs (Level 2) \newline
OSS-REQ-0130:
Catalogs (Level 1) \newline
OSS-REQ-0275:
Calibration Processing Performance Allocations \newline

\subsubsection{Provide Astrometric Model}

\label{DMS-REQ-0042}
\textbf{ID:} DMS-REQ-0042 (Priority: 1b)

\textbf{Specification:} An astrometric model shall be provided for every Object and DIAObject which specifies at least the proper motion and parallax, and the estimated uncertainties on these quantities.

\emph{Derived from Requirements:}

OSS-REQ-0149:
Level 1 Catalog Precision \newline
OSS-REQ-0153:
World Coordinate System Accuracy \newline
OSS-REQ-0160:
Level 1 Difference Source - Difference Object Association Quality \newline
OSS-REQ-0162:
Level 2 Catalog Accuracy \newline

\subsubsection{Provide Beam Projector Coordinate Calculation Software}

\label{DMS-REQ-0351}
\textbf{ID:} DMS-REQ-0351 (Priority: 1a)

\textbf{Specification:}  The DMS shall provide software to represent the coordinate transformations relating the collimated beam projector position and telescope pupil position to the illumination position on the telescope optical elements and focal plane.

\subsubsection{Enable a Range of Shape Measurement Approaches}

\label{DMS-REQ-0052}
\textbf{ID:} DMS-REQ-0052 (Priority: 1b)

\textbf{Specification:} The DMS shall provide for the use of a variety of shape models on multiple kinds of input data to measure sources: measurement on coadds; measurement on coadds using information (e.g., PSFs) extracted from the individual exposures; measurement based on all the information from the individual Exposures simultaneously.

\textbf{Discussion: }The most appropriate measurement model to apply depends upon the nature of the composite source.

\emph{Derived from Requirements:}

OSS-REQ-0137:
Catalogs (Level 2) \newline

\subsubsection{Provide User Interface Services}

\label{DMS-REQ-0160}
\textbf{ID:} DMS-REQ-0160 (Priority: 1b)

\textbf{Specification:} The DMS shall provide software for User Interface Services, including services to: browse LSST data products through astronomical views or visualizations; create and serve "best" images of selectable regions of the sky; resample and re-project images, and visualize catalog content.

\emph{Derived from Requirements:}

OSS-REQ-0057:
Image Visualization \newline

\subsection{Middleware Software}

\subsubsection{DMS Initialization Component}

\label{DMS-REQ-0297}
\textbf{ID:} DMS-REQ-0297 (Priority: 1a)

\textbf{Specification:} The DMS shall contain a component that, at each Center, can initialize the DM Subsystem into a well-defined safe state when powered up.

\textbf{Discussion: }A safe state is one that does not permit the corruption or loss of previously archived data, nor of sending spurious information over any interface.

\emph{Derived from Requirements:}

OSS-REQ-0041:
Subsystem Activation \newline
OSS-REQ-0307:
Subsystem Initialization \newline
OSS-REQ-0121:
Open Source, Open Configuration \newline
OSS-REQ-0122:
Provenance \newline

\subsubsection{Provide Data Access Services}

\label{DMS-REQ-0155}
\textbf{ID:} DMS-REQ-0155 (Priority: 1a)

\textbf{Discussion:}
(This is a composite requirement in the SysML model, which simply aggregates its children.)

\emph{Derived from Requirements:}

OSS-REQ-0176:
Data Access \newline

\paragraph{Data Product Ingest}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0299}
\textbf{ID:} DMS-REQ-0299 (Priority: 1a)

\textbf{Specification:} The DMS shall provide software to ingest data products into the Science Data Archive.

\emph{Derived from Requirements:}

OSS-REQ-0141:
Storage \newline
OSS-REQ-0004:
The Archive Facility \newline

\paragraph{Data Product and Raw Data Access}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0298}
\textbf{ID:} DMS-REQ-0298 (Priority: 1a)

\textbf{Specification:} The DMS shall provide software for Data Access Services to list and retrieve image, file, and catalog data products (including raw telescope images and calibration data), their associated metadata, their provenance, or any combination thereof, independent of their actual storage location.

\emph{Derived from Requirements:}

OSS-REQ-0176:
Data Access \newline

\paragraph{Bulk Download Service}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0300}
\textbf{ID:} DMS-REQ-0300 (Priority: 1b)

\textbf{Specification:} The DMS shall provide software to enable bulk download of data products and raw data, subject to network bandwidth.

\textbf{Discussion:} This includes bulk download of older data releases.

\emph{Derived from Requirements:}

OSS-REQ-0178:
Data Distribution \newline

\subsubsection{Provide Image Access Services}

\label{DMS-REQ-0065}
\textbf{ID:} DMS-REQ-0065 (Priority: 1b)

\textbf{Specification:} The DMS shall provide a service for Image Access through community data access protocols, to support programmatic search and retrieval of images or image cut-outs. The service shall support one or more community standard formats, including the LSST pipeline input format.

\textbf{Discussion:} At least the FITS image format will be supported though an IVOA-standard service such as SIAP. Other image formats such as JPG may be more compatible with education/public outreach needs.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0066]{DMS-REQ-0066}:
Keep Exposure Archive \newline
OSS-REQ-0180:
Data Products Query and Download Availability \newline
OSS-REQ-0181:
Data Products Query and Download Infrastructure \newline
OSS-REQ-0176:
Data Access \newline

\subsubsection{Control of Level-1 Production}

\label{DMS-REQ-0301}
\textbf{ID:} DMS-REQ-0301 (Priority: 1b)

\textbf{Specification:} The DMS shall contain a component to control all Level-1 Data Product production.

\textbf{Discussion: }This specifically addresses the need to control the Alert Production across all DMS facilities.

\emph{Derived from Requirements:}

OSS-REQ-0044:
Standard Operating States \newline

\subsubsection{Provide Pipeline Execution Services}

\label{DMS-REQ-0156}
\textbf{ID:} DMS-REQ-0156 (Priority: 1a)

\textbf{Discussion:}
(This is a composite requirement in the SysML model, which simply aggregates its children.)

\emph{Derived from Requirements:}

OSS-REQ-0037:
Observatory Control System Definition \newline
OSS-REQ-0117:
Automated Production \newline

\paragraph{Production Orchestration}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0302}
\textbf{ID:} DMS-REQ-0302 (Priority: 1a)

\textbf{Specification:} The DMS shall provide software to orchestrate execution of productions, including deploying pipelines on a computing platform.

\emph{Derived from Requirements:}

OSS-REQ-0004:
The Archive Facility \newline
OSS-REQ-0038:
Scope of Control \newline
OSS-REQ-0117:
Automated Production \newline

\paragraph{Production Monitoring}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0303}
\textbf{ID:} DMS-REQ-0303 (Priority: 1a)

\textbf{Specification:} The DMS shall provide software to monitor execution of pipelines in real time.

\emph{Derived from Requirements:}

OSS-REQ-0004:
The Archive Facility \newline
OSS-REQ-0038:
Scope of Control \newline
OSS-REQ-0034:
System Control \newline

\paragraph{Production Fault Tolerance}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0304}
\textbf{ID:} DMS-REQ-0304 (Priority: 1a)

\textbf{Specification:} The DMS shall provide software to detect faults in pipeline execution and recover when possible.

\emph{Derived from Requirements:}

OSS-REQ-0117:
Automated Production \newline

\subsubsection{Provide Pipeline Construction Services}

\label{DMS-REQ-0158}
\textbf{ID:} DMS-REQ-0158 (Priority: 1a)

\textbf{Discussion:}
(This is a composite requirement in the SysML model, which simply aggregates its children.)

\paragraph{Task Configuration}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0306}
\textbf{ID:} DMS-REQ-0306 (Priority: 1a)

\textbf{Specification:} The DMS shall provide software to define, override components of, and verify the suitability of the configuration for a task.

\emph{Derived from Requirements:}

OSS-REQ-0121:
Open Source, Open Configuration \newline
OSS-REQ-0122:
Provenance \newline

\paragraph{Task Specification}\hfill  % Force subsequent text onto new line

\label{DMS-REQ-0305}
\textbf{ID:} DMS-REQ-0305 (Priority: 1a)

\textbf{Specification:} The DMS shall provide software to define (and redefine without recompilation) a pipeline task containing a science algorithm, which may in turn consist of the execution of other subtasks.

\emph{Derived from Requirements:}

OSS-REQ-0121:
Open Source, Open Configuration \newline
OSS-REQ-0122:
Provenance \newline

\subsubsection{Unique Processing Coverage}

\label{DMS-REQ-0307}
\textbf{ID:} DMS-REQ-0307 (Priority: 2)

\textbf{Specification:} The DMS shall enable applications to process every record in a table meeting user-specified criteria exactly once.

\textbf{Commentary: }The "exactly once" constraint can be confusing to some readers and would benefit from clarification in the discussion.

\emph{Derived from Requirements:}

OSS-REQ-0120:
Consistency \newline
OSS-REQ-0118:
Consistency and Completeness \newline

\section{Facilities}

\subsection{Data Archive}

\subsubsection{Raw Data Archiving Reliability}

\label{DMS-REQ-0309}
\textbf{ID:} DMS-REQ-0309 (Priority: 1a)

\textbf{Specification:} The DMS system shall archive all data, including science, wavefront, and guider images and associated metadata, that are presented for archiving by up-stream systems, with a rate of permanent data loss or corruption not to exceed \textbf{dataLossMax}.

\textbf{Discussion: }Data "presented for archiving" means data that have been successfully transferred from upstream systems to DMS, and that are intended for permanent archiving. Data obtained for diagnostic and other limited-use engineering purposes are specifically excluded from this requirement.

\begin{parameters}
Maximum fraction of raw images that are permitted to be permanently lost or corrupted, including the loss or corruption of essential associated metadata, once acquired by the DMS.
&
1.0e-5
&
\unitname{%
float
}
&
\paramname{%
dataLossMax
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0111:
Science Image Archiving Reliability \newline

\subsubsection{Keep Historical Alert Archive}

\label{DMS-REQ-0094}
\textbf{ID:} DMS-REQ-0094 (Priority: 1b)

\textbf{Specification: }The DMS shall preserve and keep in an accessible state an alert archive with all issued alerts for a historical record and for false alert analysis.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0092]{DMS-REQ-0092}:
Alert Attributes \newline
OSS-REQ-0128:
Alerts \newline

\subsubsection{Un-Archived Data Product Cache}

\label{DMS-REQ-0310}
\textbf{ID:} DMS-REQ-0310 (Priority: 1b)

\textbf{Specification:} The DMS shall provide low-latency storage for un-archived data products of at least \textbf{l1CacheLifetime }to enable efficient precovery and other Level-1 production measurements.

\begin{parameters}
Lifetime in the cache of un-archived Level-1 data products.
&
30
&
\unitname{%
day
}
&
\paramname{%
l1CacheLifetime
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0130:
Catalogs (Level 1) \newline

\subsubsection{Regenerate Un-archived Data Products}

\label{DMS-REQ-0311}
\textbf{ID:} DMS-REQ-0311 (Priority: 1b)

\textbf{Specification:} The DMS shall be able to regenerate unarchived data products to within scientifically reasonable tolerances.

\textbf{Discussion: }Unarchived data products currently include Processed Visit Images for single visits, some Coadds, and Difference Images. Scientifically reasonable tolerances means well within the formal uncertainties of the data product, given the same production software, calibrations, and compute platform, all of which are expected to change (and improve) during the course of the survey.

\emph{Derived from Requirements:}

OSS-REQ-0129:
Exposures (Level 1) \newline

\subsubsection{Level 1 Data Product Access}

\label{DMS-REQ-0312}
\textbf{ID:} DMS-REQ-0312 (Priority: 1b)

\textbf{Specification:} The DMS shall maintain a "live" Level 1 Database for query by science users, updated as a result of Alert Production processing.

\emph{Derived from Requirements:}

OSS-REQ-0127:
Level 1 Data Product Availability \newline
OSS-REQ-0185:
Transient Alert Query \newline

\subsubsection{Level 1 \& 2 Catalog Access}

\label{DMS-REQ-0313}
\textbf{ID:} DMS-REQ-0313 (Priority: 1b)

\textbf{Specification:} The DMS shall maintain both the Level-2 catalog and the reprocessed Level-1 catalog from the most recent two Data Releases for query by science users.

\textbf{Discussion: }There is no requirement for older data releases to be queryable.

\emph{Derived from Requirements:}

OSS-REQ-0186:
Access to Previous Data Releases \newline

\subsubsection{Provide Engineering \& Facility Database Archive}

\label{DMS-REQ-0102}
\textbf{ID:} DMS-REQ-0102 (Priority: 1a)

\textbf{Specification:} Engineering and Facility data from the Observatory Control System and associated metadata shall be permanently archived by the DMS and available for public access within \textbf{L1PublicT} hours of their generation by the OCS.

\begin{parameters}
Maximum time from the acquisition of science data to the public release of associated Level 1 Data Products (except alerts)
&
24
&
\unitname{%
hour
}
&
\paramname{%
L1PublicT
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0132:
Engineering and Facility Database Archive \newline

\subsubsection{Catalog Queries}

\label{DMS-REQ-0075}
\textbf{ID:} DMS-REQ-0075 (Priority: 1a)

\textbf{Specification:} The catalogs shall be queryable with a structured language, such as SQL.

\textbf{Discussion:} Queries are expected to be generated via Science User Interfaces, and software within and external to DMS, including VO clients. The queries may be translated to (and optimized for) the native query language of the DMS database server.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0076]{DMS-REQ-0076}:
Keep Science Data Archive \newline
OSS-REQ-0176:
Data Access \newline

\subsubsection{Logging of catalog queries}

\label{DMS-REQ-0345}
\textbf{ID:} DMS-REQ-0345 (Priority: 2)

    \textbf{Specification: }Every query of LSST databases shall be logged. The logging shall contain at least the query itself, the user who submitted the query, the date and time the query was submitted, the execution time of the query, and the number of rows returned. The query history shall be available to the user that made the query but shall otherwise be private and only accessible by administrators.

    \textbf{Discussion: }The logs can be used for auditing in case of a dispute regarding data release timing. They can also be used by the data access team to learn the usage patterns of the system (such as the times of day/month with high load, or the most popular queries) and provide statistics for focusing on future developments and improvements of LSST. Whilst queries are private by default, in conjunction with \hyperref[DMS-REQ-0291]{DMS-REQ-0291}, it would be desirable for a query to be published and associated with a DOI.

\emph{Derived from Requirements:}

OSS-REQ-0134:
Level 2 Data Product Availability \newline

\subsubsection{Providing a Precovery Service}

\label{DMS-REQ-0341}
\textbf{ID:} DMS-REQ-0341 (Priority: 1b)

\textbf{Specification:} A "precovery service" shall be available to end-users to request precovery for a provided sky location across all previous visits, making the results available within \textbf{precoveryServiceElapsed} hours of the request and supporting at least\textbf{ precoveryServicePeakUsers} submissions per hour.

\textbf{Discussion:} This is forced photometry on difference images from each visit. This will include a web interface and scriptable APIs.

\begin{parameters}
Maximum time between submitting a request and receiving the results.
&
24
&
\unitname{%
hour
}
&
\paramname{%
precoveryServiceElapsed
} \\\hline
Minimum number of precovery service connections to be supported per hour.
&
10
&
\unitname{%
integer
}
&
\paramname{%
precoveryServicePeakUsers
} \\\hline
\end{parameters}

\subsubsection{Catalog Export Formats}

\label{DMS-REQ-0078}
\textbf{ID:} DMS-REQ-0078 (Priority: 1a)

\textbf{Specification:} The DMS catalog archive shall provide catalog data and associated metadata on request in community standard formats:
\begin{itemize}
\item Comma-separated ASCII text
\item eXtensible Markup Language (XML) format, including VOTable
   (\url{http://www.ivoa.net/twiki/bin/view/IVOA/IvoaVOTable}), and
\item FITS tables.
\end{itemize}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0076]{DMS-REQ-0076}:
Keep Science Data Archive \newline
OSS-REQ-0176:
Data Access \newline

\subsubsection{Maintain Archive Publicly Accessible}

\label{DMS-REQ-0077}
\textbf{ID:} DMS-REQ-0077 (Priority: 1b)

\textbf{Specification: }All releases of the DMS catalog archive shall be maintained and preserved in a publicly accessible state for the entire operational life of the LSST observatory.

\textbf{Discussion:} The scientific intent is satisfied by keeping data products from the current DRP release and the one prior available with low-latency, in a form readily queryable by the public. Earlier releases may be available from deep-store with potentially high latency, for bulk download by users.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0076]{DMS-REQ-0076}:
Keep Science Data Archive \newline
OSS-REQ-0186:
Access to Previous Data Releases \newline

\subsection{Computational Infrastructure}

\subsubsection{Data Management Unscheduled Downtime}

\label{DMS-REQ-0318}
\textbf{ID:} DMS-REQ-0318 (Priority: 1b)

\textbf{Specification:} The Data Management subsystem shall be designed to facilitate unplanned repair activities expected not to exceed \textbf{DMDowntime} days per year.

\textbf{Discussion:} This requirement does not apply to DM's alert publication and other data processing and user-interaction functionality, but only to failures in DM that directly prevent the collection of survey data. The reference case would be a failure of communication or archiving that lasted longer than the capacity of the Summit buffer -- i.e., a 3-day outage would exceed the nominal buffer capacity by one day and therefore use up the proposed allocation.

This requirement does not invoke the need to verify by reliability analysis. Verification is by analysis that identifies likely hardware failures and identifies mitigations to minimize downtime caused by those failures.

\begin{parameters}
Unplanned downtime per year.
&
1
&
\unitname{%
day
}
&
\paramname{%
DMDowntime
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0373:
Unscheduled Downtime Subsystem Allocations \newline

\subsubsection{Optimization of Cost, Reliability and Availability in Order}

\label{DMS-REQ-0161}
\textbf{ID:} DMS-REQ-0161 (Priority: 1b)

\textbf{Specification:} Within a fixed cost envelope for the Data Management subsystem, the allocation of processing and storage facilities will optimize reliability over availability to end users.

\subsubsection{Compute Platform Heterogeneity}

\label{DMS-REQ-0314}
\textbf{ID:} DMS-REQ-0314 (Priority: 1b)

\textbf{Specification:} At any given LSST computational facility the DMS shall be capable of operations on a heterogeneous cluster of machines. The hardware, operating system, and other machine parameters shall be limited to a project-approved set.

\textbf{Discussion: }The necessity of replacing hardware throughout the course of the survey essentially guarantees heterogeneity within a cluster.

\emph{Derived from Requirements:}

OSS-REQ-0177:
Data Access Environment \newline
OSS-REQ-0124:
Software Development Standards \newline

\subsubsection{Pipeline Throughput}

\label{DMS-REQ-0162}
\textbf{ID:} DMS-REQ-0162 (Priority: 1b)

\textbf{Specification:} The infrastructure will be sized such that the net throughput of the data processing pipelines will permit a complete processing of a night’s observing data prior to the start of the next observing night, assuming no system outages

\emph{Derived from Requirements:}

OSS-REQ-0127:
Level 1 Data Product Availability \newline
OSS-REQ-0020:
Usable Observing Time \newline

\subsubsection{Pipeline Availability}

\label{DMS-REQ-0008}
\textbf{ID:} DMS-REQ-0008 (Priority: 1b)

\textbf{Specification:} Except in cases of major disaster, the DMS shall have no unscheduled outages of the DMS pipelines extending over a period greater than \textbf{productionMaxDowntime}.  A major disaster is defined as a natural disaster or act of war (e.g. flood, fire, hostile acts) that compromises or threatens to compromise the health and integrity of the DMS physical facility, computing equipment, or operational personnel.

\textbf{Discussion:} This applies to active productions only. It is allowed for the Alert Production to be down for longer periods during observatory scheduled maintenance, and for the Data Release Production to be down during development and validation periods between productions.

\begin{parameters}
Maximum allowable outage of active DM production.
&
24
&
\unitname{%
hour
}
&
\paramname{%
productionMaxDowntime
} \\\hline
\end{parameters}

\subsubsection{Re-processing Capacity}

\label{DMS-REQ-0163}
\textbf{ID:} DMS-REQ-0163 (Priority: 1b)

\textbf{Specification:} The DMS shall provide Processing, Storage, and Network resources capable of executing the DMS Data Release Production over all pre-existing survey data in a time no greater than \textbf{drProcessingPeriod}, without impacting observatory operations.

\begin{parameters}
Duration of the Data Release Production, including quality validation.
&
1
&
\unitname{%
year
}
&
\paramname{%
drProcessingPeriod
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0134:
Level 2 Data Product Availability \newline

\subsubsection{Temporary Storage for Communications Links}

\label{DMS-REQ-0164}
\textbf{ID:} DMS-REQ-0164 (Priority: 1b)

    \textbf{Specification: }The infrastructure will provide for temporary storage for a minimum of \textbf{tempStorageRelMTTR} of the mean time to repair of any communications network link at the source end of that link.

\begin{parameters}
Temporary storage required relative to network Mean Time to Repair.
&
200
&
\unitname{%
percent
}
&
\paramname{%
tempStorageRelMTTR
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0162]{DMS-REQ-0162}:
Pipeline Throughput \newline

\subsubsection{Infrastructure Sizing for "catching up"}

\label{DMS-REQ-0165}
\textbf{ID:} DMS-REQ-0165 (Priority: 1b)

\textbf{Specification: }The infrastructure will be sized such that after outages, "catch up" processing of the temporarily stored raw image data may occur at the rate of one night’s observing data processed per day, without interrupting the current day's observatory operations.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0162]{DMS-REQ-0162}:
Pipeline Throughput \newline
OSS-REQ-0050:
Summit Power Grid Loss \newline
OSS-REQ-0051:
Summit-Base Connectivity Loss \newline
OSS-REQ-0052:
Summit Data Buffer \newline

\subsubsection{Incorporate Fault-Tolerance}

\label{DMS-REQ-0166}
\textbf{ID:} DMS-REQ-0166 (Priority: 1b)

\textbf{Specification: }The infrastructure will incorporate as fault-tolerance features to prevent loss of data in the event of hardware or software failure.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0161]{DMS-REQ-0161}:
Optimization of Cost, Reliability and Availability in Order \newline

\subsubsection{Incorporate Autonomics}

\label{DMS-REQ-0167}
\textbf{ID:} DMS-REQ-0167 (Priority: 2)

\textbf{Specification:} The infrastructure will incorporate sufficient capability for self-diagnostics and recovery to provide for continuation of processing in the event of partial hardware or software failures.

\textbf{Discussion: }It is understood that the system performance may degrade with increasing numbers of failures.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0166]{DMS-REQ-0166}:
Incorporate Fault-Tolerance \newline

\subsection{Summit Facility}

\subsubsection{Summit Facility Data Communications}

\label{DMS-REQ-0168}
\textbf{ID:} DMS-REQ-0168 (Priority: 1a)

\textbf{Specification:} The DMS shall provide data communications infrastructure to accept science data and associated metadata read-outs, and the collection of ancillary and engineering data, for transfer to the base facility.

\emph{Derived from Requirements:}

OSS-REQ-0002:
The Summit Facility \newline

\subsubsection{Prefer Computing and Storage Down}

\label{DMS-REQ-0170}
\textbf{ID:} DMS-REQ-0170 (Priority: 1b)

\textbf{Specification: }The DMS computing and storage equipment will be preferentially located at a lower altitude Facility (Base or Archive Center) versus the Summit Facility due to lower support costs and fewer reliability issues. Therefore any processing that can be done in either location will be allocated to a lower altitude Facility.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0161]{DMS-REQ-0161}:
Optimization of Cost, Reliability and Availability in Order \newline

\subsubsection{DMS Communication with OCS}

\label{DMS-REQ-0315}
\textbf{ID:} DMS-REQ-0315 (Priority: 1a)

\textbf{Specification:} The DMS at the Base Site shall contain a component to accept control commands from and communicate with the OCS.

\emph{Derived from Requirements:}

OSS-REQ-0003:
The Base Facility \newline

\subsection{Summit to Base}

\subsubsection{Summit to Base Network}

\label{DMS-REQ-0171}
\textbf{ID:} DMS-REQ-0171 (Priority: 1a)

\textbf{Specification:} The DMS shall provide communications infrastructure between the Summit Facility and the Base Facility sufficient to carry scientific data and associated metadata for each image in no more than time \textbf{summToBaseMaxTransferTime}.

\begin{parameters}
Maximum time interval to transfer a full Crosstalk Corrected Exposure and all related metadata from the Summit Facility to the Base facility.
&
2
&
\unitname{%
second
}
&
\paramname{%
summToBaseMaxTransferTime
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0003:
The Base Facility \newline
OSS-REQ-0127:
Level 1 Data Product Availability \newline

\subsubsection{Summit to Base Network Availability}

\label{DMS-REQ-0172}
\textbf{ID:} DMS-REQ-0172 (Priority: 1b)

\textbf{Specification:} The Summit to Base communications shall be highly available, with Mean Time Between Failures (MTBF) > \textbf{summToBaseNetMTBF}.

\begin{parameters}
Mean time between failures, measured over a 1-yr period.
&
90
&
\unitname{%
day
}
&
\paramname{%
summToBaseNetMTBF
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0161]{DMS-REQ-0161}:
Optimization of Cost, Reliability and Availability in Order \newline
OSS-REQ-0373:
Unscheduled Downtime Subsystem Allocations \newline

\subsubsection{Summit to Base Network Reliability}

\label{DMS-REQ-0173}
\textbf{ID:} DMS-REQ-0173 (Priority: 1b)

\textbf{Specification:} The Summit to Base communications shall be highly reliable, with Mean Time to Repair (MTTR) < \textbf{summToBaseNetMTTR}.

\begin{parameters}
Mean time to repair, measured over a 1-yr period.
&
24
&
\unitname{%
hour
}
&
\paramname{%
summToBaseNetMTTR
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0161]{DMS-REQ-0161}:
Optimization of Cost, Reliability and Availability in Order \newline
OSS-REQ-0373:
Unscheduled Downtime Subsystem Allocations \newline

\subsubsection{Summit to Base Network Secondary Link}

\label{DMS-REQ-0174}
\textbf{ID:} DMS-REQ-0174 (Priority: 1b)

\textbf{Specification:} The Summit to Base communications shall provide at least one secondary link or transport mechanism for minimal operations support in the event of extended outage.  This link may include redundant fiber optics, microwaves, or transportable media.  It shall be capable of transferring one night's worth of raw data in \textbf{summToBaseNet2TransMax }or less.

\begin{parameters}
Maximum time to transfer one night of data via the network secondary link.
&
72
&
\unitname{%
hour
}
&
\paramname{%
summToBaseNet2TransMax
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0172]{DMS-REQ-0172}:
Summit to Base Network Availability \newline
\hyperref[DMS-REQ-0173]{DMS-REQ-0173}:
Summit to Base Network Reliability \newline
OSS-REQ-0049:
Degraded Operational States \newline

\subsubsection{Summit to Base Network Ownership and Operation}

\label{DMS-REQ-0175}
\textbf{ID:} DMS-REQ-0175 (Priority: 1b)

\textbf{Specification:} The Summit to Base communications link shall be owned and operated by LSST and/or the operations entity to ensure responsiveness of support.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0173]{DMS-REQ-0173}:
Summit to Base Network Reliability \newline
\hyperref[DMS-REQ-0172]{DMS-REQ-0172}:
Summit to Base Network Availability \newline
OSS-REQ-0036:
Local Autonomous Administration of System Sites \newline

\subsection{Base Facility}

\subsubsection{Base Facility Infrastructure}

\label{DMS-REQ-0176}
\textbf{ID:} DMS-REQ-0176 (Priority: 1a)

\textbf{Specification:} The Base Facility shall provide sufficient computing, storage, and network infrastructure to support buffering and forwarding of all raw and crosstalk-corrected image data to the Archive Facility, a complete copy of the Archive Facility data holdings, and compute facilities to support Commissioning activities.

\textbf{Discussion:} The Base Facility is co-located with the Chilean DAC, and also serves as a back-up for the Archive Center in the event of disaster.

\emph{Derived from Requirements:}

OSS-REQ-0003:
The Base Facility \newline

\subsubsection{Base Facility Temporary Storage}

\label{DMS-REQ-0177}
\textbf{ID:} DMS-REQ-0177 (Priority: 1b)

\textbf{Specification:} The Base Facility shall provide at least a time \textbf{minBaseDataStorage }(or half of that amount, redundantly) of raw data storage in the event of Base to Archive Center network outage.

\begin{parameters}
Low-latency storage buffer capacity, expressed in units of data volume equivalent for a typical day's data collection.
&
14
&
\unitname{%
day
}
&
\paramname{%
minBaseDataStorage
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0164]{DMS-REQ-0164}:
Temporary Storage for Communications Links \newline
OSS-REQ-0053:
Base-Archive Connectivity Loss \newline
OSS-REQ-0054:
Base Data Buffer \newline

\subsubsection{Base Facility Co-Location with Existing Facility}

\label{DMS-REQ-0178}
\textbf{ID:} DMS-REQ-0178 (Priority: 1b)

\textbf{Specification:} The Base Facility shall be co-located at an existing facility to leverage existing support and facility resources

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0161]{DMS-REQ-0161}:
Optimization of Cost, Reliability and Availability in Order \newline
OSS-REQ-0006:
Sites \newline

\subsubsection{Commissioning Cluster}

\label{DMS-REQ-0316}
\textbf{ID:} DMS-REQ-0316 (Priority: 1a)

\textbf{Specification:} The Base Facility shall include a compute cluster to be made available to the Systems Engineering group for use in commissioning.  Data Management will not administer or otherwise maintain this cluster following hardware installation. The budget for this cluster shall be at least \textbf{budgetRelAlertProd} of the budget for Alert Production hardware.

\begin{parameters}
Budget relative to the cost of the Alert Production system.
&
10
&
\unitname{%
percent
}
&
\paramname{%
budgetRelAlertProd
} \\\hline
\end{parameters}

\subsubsection{Base Wireless LAN (WiFi)}

\label{DMS-REQ-0352}
\textbf{ID:} DMS-REQ-0352 (Priority: 2)

\textbf{Specification:}
The Base LAN shall provide \textbf{minBaseWiFi} Wireless LAN (WiFi) and Wireless Access Points in the Base Facility to support connectivity of individual user's computers to the network backbones.

\begin{parameters}
Maximum allowable outage of active DM production.
&
1000
&
\unitname{%
megabit per second
}
&
\paramname{%
minBaseWifi
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

OSS-REQ-0003:
The Base Facility \newline

\subsection{Base to Archive}

\subsubsection{Base to Archive Network}

\label{DMS-REQ-0180}
\textbf{ID:} DMS-REQ-0180 (Priority: 1b)

\textbf{Specification:} The DMS shall provide communications infrastructure between the Base Facility and the Archive Center sufficient to carry scientific data and associated metadata for each image in no more than time \textbf{baseToArchiveMaxTransferTime}.

\begin{parameters}
Maximum time interval to transfer a full Crosstalk Corrected Exposure and all related metadata from the Base Facility to the Archive Center.
&
5
&
\unitname{%
second
}
&
\paramname{%
baseToArchiveMaxTransferTime
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0162]{DMS-REQ-0162}:
Pipeline Throughput \newline
OSS-REQ-0053:
Base-Archive Connectivity Loss \newline
OSS-REQ-0055:
Base Updating from Archive \newline

\subsubsection{Base to Archive Network Availability}

\label{DMS-REQ-0181}
\textbf{ID:} DMS-REQ-0181 (Priority: 1b)

\textbf{Specification: }The Base to Archive communications shall be highly available, with MTBF >  \textbf{baseToArchNetMTBF}.

\begin{parameters}
Mean time between failures, measured over a 1-yr period.
&
180
&
\unitname{%
day
}
&
\paramname{%
baseToArchNetMTBF
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0161]{DMS-REQ-0161}:
Optimization of Cost, Reliability and Availability in Order \newline
\hyperref[DMS-REQ-0162]{DMS-REQ-0162}:
Pipeline Throughput \newline
OSS-REQ-0053:
Base-Archive Connectivity Loss \newline

\subsubsection{Base to Archive Network Reliability}

\label{DMS-REQ-0182}
\textbf{ID:} DMS-REQ-0182 (Priority: 1b)

\textbf{Specification:} The Base to Archive communications shall be highly reliable, with MTTR <  \textbf{baseToArchNetMTTR}.

\begin{parameters}
Mean time to repair, measured over a 1-yr period.
&
48
&
\unitname{%
hour
}
&
\paramname{%
baseToArchNetMTTR
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0161]{DMS-REQ-0161}:
Optimization of Cost, Reliability and Availability in Order \newline
OSS-REQ-0053:
Base-Archive Connectivity Loss \newline

\subsubsection{Base to Archive Network Secondary Link}

\label{DMS-REQ-0183}
\textbf{ID:} DMS-REQ-0183 (Priority: 1b)

\textbf{Specification: }The Base to Archive communications shall provide secondary link or transport mechanism (e.g. protected circuit) for operations support and "catch up"  in the event of extended outage.  This secondary link shall be capable of "bursting" to at least twice the capacity of the primary link.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0182]{DMS-REQ-0182}:
Base to Archive Network Reliability \newline
\hyperref[DMS-REQ-0181]{DMS-REQ-0181}:
Base to Archive Network Availability \newline
OSS-REQ-0049:
Degraded Operational States \newline

\subsection{Archive Center}

\subsubsection{Archive Center}

\label{DMS-REQ-0185}
\textbf{ID:} DMS-REQ-0185 (Priority: 1a)

\textbf{Specification:} The Archive Center shall provide computing, storage, and network infrastructure to support, simultaneously: nightly processing including image processing, detection, association, and moving object pipelines, and the generation of all time-critical data products, i.e. alerts; the data release production, including Level-2 data product creation, permanent storage for all data products (with provenance), including federated Level-3 products; and serve data for replication to data centers and end user sites.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0163]{DMS-REQ-0163}:
Re-processing Capacity \newline
OSS-REQ-0004:
The Archive Facility \newline

\subsubsection{Archive Center Disaster Recovery}

\label{DMS-REQ-0186}
\textbf{ID:} DMS-REQ-0186 (Priority: 1a)

\textbf{Specification:} The Archive Center shall provide disaster recovery support preventing loss of LSST data in the case of infrastructure or facility-threatening events.  This support shall enable recovery of all LSST archived data from backed up sources, including Data Access Centers.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0161]{DMS-REQ-0161}:
Optimization of Cost, Reliability and Availability in Order \newline
OSS-REQ-0176:
Data Access \newline

\subsubsection{Archive Center Co-Location with Existing Facility}

\label{DMS-REQ-0187}
\textbf{ID:} DMS-REQ-0187 (Priority: 1b)

\textbf{Specification:} The Archive Center shall be hosted at an existing NSF/DOE-funded supercomputing center.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0161]{DMS-REQ-0161}:
Optimization of Cost, Reliability and Availability in Order \newline
OSS-REQ-0022:
Archive Site \newline

\subsection{Archive to Data Access Center}

\subsubsection{Archive to Data Access Center Network}

\label{DMS-REQ-0188}
\textbf{ID:} DMS-REQ-0188 (Priority: 1b)

\textbf{Specification:} The DMS shall provide communications infrastructure between the Archive Center and Data Access Centers sufficient to carry scientific data and associated metadata in support of community and EPO access. Aggregate bandwidth for data transfers from the Archive Center to Data Centers shall be at least \textbf{archToDacBandwidth}.

\begin{parameters}
Aggregate bandwidth capacity for data transfers between the Archive and Data Access Centers.
&
10000
&
\unitname{%
megabit per second
}
&
\paramname{%
archToDacBandwidth
} \\\hline
\end{parameters}

\subsubsection{Archive to Data Access Center Network Availability}

\label{DMS-REQ-0189}
\textbf{ID:} DMS-REQ-0189 (Priority: 1b)

\textbf{Specification:} The Archive to Data Access Center communications shall be highly available, with MTBF > \textbf{archToDacNetMTBF}.

\begin{parameters}
Mean Time Between Failures for data service between Archive and DACs, averaged over a one-year period.
&
180
&
\unitname{%
day
}
&
\paramname{%
archToDacNetMTBF
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0161]{DMS-REQ-0161}:
Optimization of Cost, Reliability and Availability in Order \newline

\subsubsection{Archive to Data Access Center Network Reliability}

\label{DMS-REQ-0190}
\textbf{ID:} DMS-REQ-0190 (Priority: 1b)

\textbf{Specification:} The Archive to Data Access Center communications shall be highly reliable, with MTTR < \textbf{archToDacNetMTTR}.

\begin{parameters}
Mean time to repair, measured over a 1-yr period.
&
48
&
\unitname{%
hour
}
&
\paramname{%
archToDacNetMTTR
} \\\hline
\end{parameters}

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0161]{DMS-REQ-0161}:
Optimization of Cost, Reliability and Availability in Order \newline

\subsubsection{Archive to Data Access Center Network Secondary Link}

\label{DMS-REQ-0191}
\textbf{ID:} DMS-REQ-0191 (Priority: 1b)

\textbf{Specification: }The Archive to Data Access Center communications shall provide secondary link or transport mechanism (e.g. protected circuit) for operations support and "catch up" in the event of extended outage.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0189]{DMS-REQ-0189}:
Archive to Data Access Center Network Availability \newline
\hyperref[DMS-REQ-0190]{DMS-REQ-0190}:
Archive to Data Access Center Network Reliability \newline

\subsection{Data Access Center}

\subsubsection{Data Access Centers}

\label{DMS-REQ-0193}
\textbf{ID:} DMS-REQ-0193 (Priority: 1b)

\textbf{Specification:} The Data Access Centers shall provide computing, storage, and network infrastructure to support open access to LSST data products (with provenance) by end users.

\emph{Derived from Requirements:}

OSS-REQ-0004:
The Archive Facility \newline

\subsubsection{Data Access Center Simultaneous Connections}

\label{DMS-REQ-0194}
\textbf{ID:} DMS-REQ-0194 (Priority: 1b)

\textbf{Specification:} At least \textbf{dacMinConnections }simultaneous connections shall be supported at each Data Access Center.

\begin{parameters}
Minimum simultaneous connections to end-users.
&
300
&
\unitname{%
integer
}
&
\paramname{%
dacMinConnections
} \\\hline
\end{parameters}

\subsubsection{Access to catalogs for external Level 3 processing}

\label{DMS-REQ-0122}
\textbf{ID:} DMS-REQ-0122 (Priority: 2)

\textbf{Specification: }The DMS shall facilitate Level 3 catalog processing that may take place at external facilities outside the DACs.  This will principally be by facilitating the export of catalogs and the provision of tools for maintaining and validating exported data.

\emph{Derived from Requirements:}

OSS-REQ-0140:
Production \newline
OSS-REQ-0180:
Data Products Query and Download Availability \newline

\subsubsection{Access to images for external Level 3 processing}

\label{DMS-REQ-0126}
\textbf{ID:} DMS-REQ-0126 (Priority: 2)

\textbf{Specification: }The DMS shall facilitate Level 3 image processing that may take place at external facilities outside the DACs.  This will principally be by facilitating the export of image datasets and the provision of tools for maintaining and validating exported data.

\emph{Derived from Requirements:}

OSS-REQ-0140:
Production \newline
OSS-REQ-0180:
Data Products Query and Download Availability \newline

\subsubsection{Access to input catalogs for DAC-based Level 3 processing}

\label{DMS-REQ-0123}
\textbf{ID:} DMS-REQ-0123 (Priority: 2)

\textbf{Specification: }The DMS shall provide access to all Level 1 and Level 2 catalog products through the LSST project's Data Access Centers, and any others that have been established and funded, for Level 3 processing that takes place at the DACs.

\emph{Derived from Requirements:}

OSS-REQ-0140:
Production \newline

\subsubsection{Access to input images for DAC-based Level 3 processing}

\label{DMS-REQ-0127}
\textbf{ID:} DMS-REQ-0127 (Priority: 2)

\textbf{Specification:} The DMS shall provide access to all Level 1 and Level 2 image products through the LSST project's Data Access Centers, and any others that have been established and funded, for Level 3 processing that takes place at the DACs.

\emph{Derived from Requirements:}

OSS-REQ-0140:
Production \newline

\subsubsection{Federation with external catalogs}

\label{DMS-REQ-0124}
\textbf{ID:} DMS-REQ-0124 (Priority: 2)

\textbf{Specification: }The DMS shall provide a means for federating Level 1, 2, and 3 catalogs with externally provided catalogs, for joint analysis.  The DMS shall provide specifications for how external data must be provided in order for this to be achieved. The DMS shall strive to support community standards in this regard, including, but not limited to, virtual observatory facilities that may be available during the project lifetime.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0125]{DMS-REQ-0125}:
Software framework for Level 3 catalog processing \newline
OSS-REQ-0140:
Production \newline

\subsubsection{Data Access Center Geographical Distribution}

\label{DMS-REQ-0196}
\textbf{ID:} DMS-REQ-0196 (Priority: 1b)

\textbf{Specification:} The Data Access Centers will be hosted at facilities selected in at least the U.S. and the observatory host country to permit widest possible access to LSST data with the fewest possible network hops.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0193]{DMS-REQ-0193}:
Data Access Centers \newline
OSS-REQ-0021:
Base Site \newline
OSS-REQ-0022:
Archive Site \newline

\subsubsection{No Limit on Data Access Centers}

\label{DMS-REQ-0197}
\textbf{ID:} DMS-REQ-0197 (Priority: 2)

\textbf{Specification: }The number of Data Access Centers shall be limited only by available internal or external funding.  No architectural constraints will be placed on the DMS that prohibit the addition of Data Access Centers at any time, subject to funding.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0193]{DMS-REQ-0193}:
Data Access Centers \newline
OSS-REQ-0021:
Base Site \newline
OSS-REQ-0022:
Archive Site \newline

\section{Deleted Requirements}

This sections lists all the requirements that have been deleted from the official baseline.

\subsection{Timely Publication of Level 2 Data Releases}

\label{DMS-REQ-0006}
\textbf{ID:} DMS-REQ-0006 (Priority: 1b)

\textbf{Specification:} The DMS shall make available to end-users all Level-2 data products as soon as possible following the execution of the Data Release Production and the verification of science data quality.

\textbf{Discussion:}
Removed as part of LCR-962.

\emph{Derived from Requirements:}

\hyperref[DMS-REQ-0005]{DMS-REQ-0005}:
Produce Data Releases \newline
OSS-REQ-0134:
Level 2 Data Product Availability \newline

\bibliography{lsst}

\end{document}
