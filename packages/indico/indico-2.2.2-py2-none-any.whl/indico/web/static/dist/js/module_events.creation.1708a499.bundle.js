!function(e){function t(t){for(var n,i,c=t[0],l=t[1],d=t[2],u=0,v=[];u<c.length;u++)i=c[u],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&v.push(a[i][0]),a[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(s&&s(t);v.length;)v.shift()();return r.push.apply(r,d||[]),o()}function o(){for(var e,t=0;t<r.length;t++){for(var o=r[t],n=!0,c=1;c<o.length;c++){var l=o[c];0!==a[l]&&(n=!1)}n&&(r.splice(t--,1),e=i(i.s=o[0]))}return e}var n={},a={148:0},r=[];function i(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.e=function(){return Promise.resolve()},i.m=e,i.c=n,i.d=function(e,t,o){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(o,n,function(t){return e[t]}.bind(null,n));return o},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/";var c=window.coreJsonp=window.coreJsonp||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var s=l;r.push([1750,0]),o()}({1750:function(e,t,o){e.exports=o(1751)},1751:function(e,t,o){"use strict";o.r(t),function(e){var t=o(17),n=o.n(t),a=o(22);const r=n.a.bind(null,{endpoint:"rb.roombooking",rules:[{args:["path"],converters:{path:"PathConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/rooms/",isDynamic:!1},{data:"path",isDynamic:!0}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/rooms",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),i=n.a.bind(null,{endpoint:"rb.check_room_available",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/rooms/api/rooms/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/availability/simple",isDynamic:!1}]}]},"/");window.setupEventCreationDialog=function(t){t=$.extend({categoryField:null,protectionModeFields:null,initialCategory:null,checkAvailability:!1,rbExcludedCategories:null,serverDefaultTimezone:null},t);const o=$($.parseHTML($("#event-creation-protection-messages").html())),n=$("<div>",{class:"form-group",css:{marginTop:"5px"}}),c=$("#event-creation-create_booking"),l=$("#room-available"),d=$("#room-available-prebook"),s=$("#room-conflict-booking"),u=$("#room-conflict-prebooking"),v=$("#room-conflict-prebooking-prebook"),m=$("#room-user-booking"),p=$("#room-user-prebooking"),f=$("#room-unbookable"),g=$("#room-cannot-book"),h=$("#create-booking"),b=$("#create-prebooking"),y=$("#create-booking-over-prebooking"),_=$("#create-prebooking-over-prebooking");let Y,M,k,D,H,O,S,T=null,j=!1;function x(){let e=t.protectionModeFields.filter(":checked").val();"inheriting"===e&&(e=T.is_protected?"inheriting-protected":"inheriting-public");const a=o.filter(".{0}-protection-message".format(e));a.find(".js-category-title").text(T.title),n.html(a)}function P(t){k=e("".concat(t.date," ").concat(t.time),"YYYY-MM-DD HH:mm"),D=e(k).add(t.duration,"minutes")}function F(e){const t={path:"calendar",date:k.format("YYYY-MM-DD"),text:O.room_name},o=r(t);e.find("a").prop("href",o)}function w(){if(function(e){M&&(e&&($("#availability-messages").find("input[id^='create']").prop("checked",!1),c.val("false")),M.hide())}(arguments.length>0&&void 0!==arguments[0]&&arguments[0]),!("room_id"in O)||!k.isValid()||!D.isValid()||!k.isSame(D,"day")||k.isSameOrAfter(D)||(o=H.id,t.rbExcludedCategories.some(e=>parseInt(e.id,10)===o))||S!==t.serverDefaultTimezone||j)return void c.val("false");var o;const n={room_id:O.room_id,start_dt:k.format(e.HTML5_FMT.DATETIME_LOCAL),end_dt:D.format(e.HTML5_FMT.DATETIME_LOCAL)};$.ajax({url:i(n),method:"GET",dataType:"json",contentType:"application/json",error:handleAjaxError,success(e){(e=Object(a.a)(e)).userBooking?(c.val("false"),F(M=m)):e.userPrebooking?(c.val("false"),F(M=p)):e.conflictBooking?(c.val("false"),F(M=s)):e.unbookable?(c.val("false"),F(M=f)):e.conflictPrebooking?e.canBook?(c.val(String(y[0].checked)),F(M=u)):e.canPrebook?(c.val(String(_[0].checked)),F(M=v)):(c.val("false"),M=g):e.canBook?(c.val(String(h[0].checked)),M=l):e.canPrebook?(c.val(String(b[0].checked)),M=d):(c.val("false"),M=g),M.show()}})}n.appendTo(t.protectionModeFields.closest(".form-field")),t.categoryField.on("indico:categorySelected",(e,o)=>{T||(t.protectionModeFields.prop("disabled",!1),t.protectionModeFields.filter("[value=inheriting]").prop("checked",!0)),T=o,x()}),t.protectionModeFields.on("change",function(){x()}),t.initialCategory?t.categoryField.trigger("indico:categorySelected",[t.initialCategory]):t.protectionModeFields.prop("disabled",!0),t.checkAvailability&&(function(){const t=$("#event-creation-start_dt-date").val(),o=$("#event-creation-start_dt-time").val(),n=$("#event-creation-end_dt-date").val(),a=$("#event-creation-end_dt-time").val(),r=$("#event-creation-occurrences").val(),i=r?JSON.parse(r):null;O=JSON.parse($("#event-creation-location_data").val()),S=$("#event-creation-timezone").val(),H=JSON.parse($("#event-creation-category").val()),i&&1===i.length?P(i[0]):(k=e("".concat(t," ").concat(o),"DD/MM/YYYY HH:mm"),D=e("".concat(n," ").concat(a),"DD/MM/YYYY HH:mm"))}(),$("#event-creation-location_data").on("change",function(){O=JSON.parse($(this).val()),Y!==O.room_id&&(Y=O.room_id,w(!0))}),$("#event-creation-start_dt-date").on("change",function(){const t=$(this).val(),o=$("#event-creation-start_dt-time").val(),n=$("#event-creation-end_dt-date").val(),a=$("#event-creation-end_dt-time").val();k=e("".concat(t," ").concat(o),"DD/MM/YYYY HH:mm"),(D=e("".concat(n," ").concat(a),"DD/MM/YYYY HH:mm")).isBefore(k)&&(D=e("".concat(t," ").concat(a),"DD/MM/YYYY HH:mm")),w()}),$("#event-creation-start_dt-time").on("change",function(){const t=$("#event-creation-start_dt-date").val(),o=$("#event-creation-start_dt-time").val();k=e("".concat(t," ").concat(o),"DD/MM/YYYY HH:mm"),w()}),$("#event-creation-end_dt-date").on("change",function(){const t=$(this).val(),o=$("#event-creation-end_dt-time").val();D=e("".concat(t," ").concat(o),"DD/MM/YYYY HH:mm"),w()}),$("#event-creation-end_dt-time").on("change",function(){const t=$("#event-creation-end_dt-date").val(),o=$(this).val();D=e("".concat(t," ").concat(o),"DD/MM/YYYY HH:mm"),w()}),$("#event-creation-occurrences").on("change",function(){const e=JSON.parse($(this).val());1===e.length?(P(e[0]),j=!1):j=!0,w()}),$("#event-creation-timezone").on("change",function(){S=$(this).val(),w()}),$("#event-creation-category").on("change",function(){H=JSON.parse($(this).val()),w()}),h.add(b).add(y).add(_).on("change",function(){c.val(String(this.checked))}))}}.call(this,o(6))}});
//# sourceMappingURL=module_events.creation.1708a499.bundle.js.map