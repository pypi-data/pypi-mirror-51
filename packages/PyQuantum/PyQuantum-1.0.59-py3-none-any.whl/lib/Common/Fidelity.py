# -------------------------------------------------------------------------------------------------
# scientific
import numpy as np
import scipy.linalg as lg
# -------------------------------------------------------------------------------------------------
from PyQuantum.Common.Matrix import *

# -------------------------------------------------------------------------------------------------


def Fidelity(ro_sqrt, sigma):
    fid_matrix = lg.fractional_matrix_power(
        ro_sqrt.dot(sigma).dot(ro_sqrt), 0.5)
    return np.trace(np.abs(fid_matrix))
# -------------------------------------------------------------------------------------------------
