
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Vagrant &#8212; bodhi 4.1.0 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Virtualenv" href="virtualenv.html" />
    <link rel="prev" title="Release process" href="releases.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="vagrant">
<h1>Vagrant<a class="headerlink" href="#vagrant" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://www.vagrantup.com">Vagrant</a> allows contributors to get quickly up and running with a Bodhi development environment by
automatically configuring a virtual machine. Before you get started, ensure that your host machine
has virtualization extensions enabled in its BIOS so the guest doesn’t go slower than molasses. To
get started, simply use these commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo dnf install ansible libvirt vagrant-libvirt vagrant-sshfs
$ sudo systemctl enable libvirtd
$ sudo systemctl start libvirtd
</pre></div>
</div>
<p>Check out the code and run <code class="docutils literal notranslate"><span class="pre">vagrant</span> <span class="pre">up</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/fedora-infra/bodhi
$ cd bodhi
$ vagrant up
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Vagrantfile</span></code> sets up a port forward from the host machine’s port 6543 into the Vagrant
guest’s port 6543, so you can now visit <a class="reference external" href="http://localhost:6543">http://localhost:6543</a> with your browser to see your Bodhi
development instance if your browser is on the same host as the Vagrant host. If not, you will need
to connect to port 6543 on your Vagrant host, which is an exercise left for the reader.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Vagrantfile</span></code> also sets up a port forward from the host machine’s port
15672 to the Vagrant guest’s port 15672. The Vagrant guest runs an AMQP message
broker (RabbitMQ) which has a web interface for monitoring and administration
at <a class="reference external" href="http://localhost:15672">http://localhost:15672</a>. The default username is “guest” and the password is
“guest”.</p>
<div class="section" id="quick-tips-about-the-bodhi-vagrant-environment">
<h2>Quick tips about the Bodhi Vagrant environment<a class="headerlink" href="#quick-tips-about-the-bodhi-vagrant-environment" title="Permalink to this headline">¶</a></h2>
<p>You can ssh into your running Vagrant box like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Make sure your bodhi checkout is your shell&#39;s cwd
$ vagrant ssh
</pre></div>
</div>
<p>Once you are inside the development environment, there are a helpful set of commands in your
<code class="docutils literal notranslate"><span class="pre">.bashrc</span></code> that will be printed to the screen via the <code class="docutils literal notranslate"><span class="pre">/etc/motd</span></code> file. Be sure to familiarize
yourself with these:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
Welcome to the Bodhi development environment! Here are some helpful commands:

bci:         Run the Bodhi CI test suite.
bdocs:       Build Bodhi&#39;s documentation.
bfedmsg:     Display the log of Bodhi&#39;s messages on the bus.
blog:        View Bodhi&#39;s log. (Support all the systemctl options, such as -lf)
bresetdb:    Drop and reimport the database.
brestart:    Restart the Bodhi service.
bodhi-shell: Get a handy python shell initialized with Bodhi models.
bstart:      Start the Bodhi service.
bstop:       Stop the Bodhi service.
btest:       Run Bodhi&#39;s test suite.
blint:       Run a series of linter checks.
bstartdeps:  Create and Run WaiverDB and Greenwave docker services
bstopdeps:   Stop WaiverDB and Greenwave docker services
bremovedeps: Destroy WaiverDB and Greenwave docker services


The BODHI_URL environment variable is set to http://localhost:6543 so the
bodhi client will use the local development server.

Happy hacking!
</pre></div>
</div>
<p>Keep in mind that all <code class="docutils literal notranslate"><span class="pre">vagrant</span></code> commands should be run with your current working directory set to
your Bodhi checkout. The code from your development host will be mounted in <code class="docutils literal notranslate"><span class="pre">/home/vagrant/bodhi</span></code>
in the guest. You can edit this code on the host, and the vagrant-sshfs plugin will cause the
changes to automatically be reflected in the guest’s <code class="docutils literal notranslate"><span class="pre">/home/vagrant/bodhi</span></code> folder.</p>
<p>The development server is run inside the Vagrant environment by the <code class="docutils literal notranslate"><span class="pre">bodhi.service</span></code> systemd unit.
You can use <code class="docutils literal notranslate"><span class="pre">bodhi-shell</span></code> to get a Python shell quickly set up with a nice environment for you to hack
in. Here’s an example where we use <code class="docutils literal notranslate"><span class="pre">bodhi-shell</span></code> to set an update’s request to stable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[vagrant@bodhi-dev bodhi]$ bodhi-shell
2017-11-02 21:08:56,359 INFO  [bodhi][MainThread] Using the FakeBugTracker
2017-11-02 21:08:56,359 DEBUG [bodhi][MainThread] Using DevBuildsys
Python 2.7.13 (default, May 10 2017, 20:04:28)
Type &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.

IPython 3.2.1 -- An enhanced Interactive Python.
?         -&gt; Introduction and overview of IPython&#39;s features.
%quickref -&gt; Quick reference.
help      -&gt; Python&#39;s own help system.
object?   -&gt; Details about &#39;object&#39;, use &#39;object??&#39; for extra details.

Environment:
  app          The WSGI application.
  registry     Active Pyramid registry.
  request      Active request object.
  root         Root of the default resource tree.
  root_factory Default root factory used to create `root`.

Custom Variables:
  m            bodhi.server.models
  s            bodhi.server.Session

In [1]: u = m.Update.query.filter_by(alias=&#39;FEDORA-2016-840ff89708&#39;).one()

In [2]: u.request = m.UpdateRequest.stable

In [3]: s().commit()
</pre></div>
</div>
<p>When you are done with your Vagrant guest, you can destroy it permanently by running this command on
the host:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ vagrant destroy
</pre></div>
</div>
<p>If you wish to use a custom <code class="docutils literal notranslate"><span class="pre">Vagrantfile</span></code>, you can set the environment variable
<code class="docutils literal notranslate"><span class="pre">VAGRANT_VAGRANTFILE</span></code> as a path to a script.</p>
</div>
<div class="section" id="authentication">
<h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h2>
<p>The Vagrant environment will configure Bodhi server and Bodhi’s CLI to use Fedora’s staging Ipsilon
server for authentication. This means you will need to ensure you have an account on Fedora’s
staging account system. If you need to make an account, you can do so
<a class="reference external" href="https://admin.stg.fedoraproject.org/accounts/">here</a>. This is done to prevent accidental changes
to Fedora’s production instance during development.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.svg" alt="Logo"/>
    
    <h1 class="logo logo-name">bodhi</h1>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=fedora-infra&repo=bodhi&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/testing.html">Testing updates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/update_states.html">Update states</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/buildroot_overrides.html">Buildroot Overrides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/man_pages/index.html">Man pages</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/release_notes.html">Release notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../server_api/index.html">Bodhi Server APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_bindings.html">Python bindings</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Developer documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Release process</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Vagrant</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#quick-tips-about-the-bodhi-vagrant-environment">Quick tips about the Bodhi Vagrant environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#authentication">Authentication</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="virtualenv.html">Virtualenv</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Database models</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../administration.html">Administration</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="releases.html" title="previous chapter">Release process</a></li>
      <li>Next: <a href="virtualenv.html" title="next chapter">Virtualenv</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2007-2019, Red Hat, Inc..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.11</a>
      
      |
      <a href="../_sources/developer/vagrant.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>