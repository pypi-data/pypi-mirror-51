# Auto-generated by the Cortex Python SDK

FROM {{base_image}}

WORKDIR /app


RUN conda config --add channels conda-forge
RUN conda install --yes flask gunicorn

COPY conda_requirements.txt .
RUN conda install --yes --file conda_requirements.txt

RUN pip install "dill==0.2.8.2" "cortex-client=={{cortex_sdk_version}}"

COPY requirements.txt .
RUN pip install -r requirements.txt

{% if deploy_archive %}
COPY action.tar .
RUN tar xf action.tar --strip 1
{% endif %}

COPY action.py .

EXPOSE {{port}}

ENTRYPOINT ["gunicorn", "-b", "0.0.0.0:{{port}}", "-t", "60", "action:app"]
